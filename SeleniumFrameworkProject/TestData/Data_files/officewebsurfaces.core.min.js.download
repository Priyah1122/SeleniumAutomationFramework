/*! For license information please see officewebsurfaces.core.min.js.LICENSE.txt */
var OfficeWebSurfaces=function(e){function t(t){for(var n,o,i=t[0],a=t[1],s=0,u=[];s<i.length;s++)o=i[s],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&u.push(r[o][0]),r[o]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={0:0};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,o){n=r[e]=[t,o]}));t.push(n[2]=i);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+""+({1:"officewebsurfaces.fabric"}[e]||e)+".523eef76772813c169bb.min.js"}(e);var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",c.name="ChunkLoadError",c.type=o,c.request=i,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var i=window.webpackJsonpOfficeWebSurfaces=window.webpackJsonpOfficeWebSurfaces||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var c=a;return o(o.s=12)}([function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return l}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s}));var r,o,i=new(n(6).a);function a(e,t,n){i.fireEvent({level:e,category:t,message:n})}function s(e,t,n){a(r.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(r||(r={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(o||(o={}))},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(r||(r={}))},function(e,t,n){var r=n(15),o=n(16),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}()},,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){"use strict";function r(e,t){return void 0===t&&(t=!0),e&&(t&&function(e){var t,n;return e&&((n=e)&&n._virtual)&&(t=e._virtual.parent),t}(e)||e.parentNode&&e.parentNode)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOTelSink=void 0;var r=n(18);t.createOTelSink=function(){return new r.SdxWacSink}},function(e,t,n){e.exports=n(17)},function(e,t){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=window.document,t=[],n=null,r=null;i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i._setupCrossOriginUpdater=function(){return n||(n=function(e,n){r=e&&n?l(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),n},i._resetCrossOriginUpdater=function(){n=null,r=null},i.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},i.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},i.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,o=null,i=null;if(this.POLL_INTERVAL?o=n.setInterval(r,this.POLL_INTERVAL):(a(n,"resize",r,!0),a(t,"scroll",r,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(i=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(o&&e.clearInterval(o),s(e,"resize",r,!0)),s(t,"scroll",r,!0),i&&i.disconnect()})),t!=(this.root&&this.root.ownerDocument||e)){var c=v(t);c&&this._monitorIntersections(c.ownerDocument)}}},i.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&this.root.ownerDocument||e;if(!this._observationTargets.some((function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var o=v(n);if((n=o&&o.ownerDocument)==t)return!0}return!1}))){var o=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),o(),t!=r){var i=v(t);i&&this._unmonitorIntersections(i.ownerDocument)}}}},i.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},i.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(r){var i=r.element,a=c(i),s=this._rootContainsTarget(i),u=r.entry,l=e&&s&&this._computeTargetAndRootIntersection(i,a,t),f=r.entry=new o({time:window.performance&&performance.now&&performance.now(),target:i,boundingClientRect:a,rootBounds:n&&!this.root?null:t,intersectionRect:l});u?e&&s?this._hasCrossedThreshold(u,f)&&this._queuedEntries.push(f):u&&u.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},i.prototype._computeTargetAndRootIntersection=function(t,o,i){if("none"!=window.getComputedStyle(t).display){for(var a,s,u,f,v,p,h,g,m=o,y=d(t),b=!1;!b&&y;){var w=null,S=1==y.nodeType?window.getComputedStyle(y):{};if("none"==S.display)return null;if(y==this.root||9==y.nodeType)if(b=!0,y==this.root||y==e)n&&!this.root?!r||0==r.width&&0==r.height?(y=null,w=null,m=null):w=r:w=i;else{var T=d(y),C=T&&c(T),E=T&&this._computeTargetAndRootIntersection(T,C,i);C&&E?(y=T,w=l(C,E)):(y=null,m=null)}else{var O=y.ownerDocument;y!=O.body&&y!=O.documentElement&&"visible"!=S.overflow&&(w=c(y))}if(w&&(a=w,s=m,u=void 0,f=void 0,v=void 0,p=void 0,h=void 0,g=void 0,u=Math.max(a.top,s.top),f=Math.min(a.bottom,s.bottom),v=Math.max(a.left,s.left),p=Math.min(a.right,s.right),g=f-u,m=(h=p-v)>=0&&g>=0&&{top:u,bottom:f,left:v,right:p,width:h,height:g}||null),!m)break;y=y&&d(y)}return m}},i.prototype._getRootRect=function(){var t;if(this.root)t=c(this.root);else{var n=e.documentElement,r=e.body;t={top:0,left:0,right:n.clientWidth||r.clientWidth,width:n.clientWidth||r.clientWidth,bottom:n.clientHeight||r.clientHeight,height:n.clientHeight||r.clientHeight}}return this._expandRectByRootMargin(t)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},i.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var o=0;o<this.thresholds.length;o++){var i=this.thresholds[o];if(i==n||i==r||i<n!=i<r)return!0}},i.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},i.prototype._rootContainsTarget=function(t){return f(this.root||e,t)&&(!this.root||this.root.ownerDocument==t.ownerDocument)},i.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},i.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=o}function o(e){this.time=e.time,this.target=e.target,this.rootBounds=u(e.rootBounds),this.boundingClientRect=u(e.boundingClientRect),this.intersectionRect=u(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,o=r.width*r.height;this.intersectionRatio=n?Number((o/n).toFixed(4)):this.isIntersecting?1:0}function i(e,t){var n,r,o,i=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout((function(){n(),o=null}),r))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function a(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function s(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function c(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function u(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function l(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=d(n)}return!1}function d(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?v(t):n&&11==n.nodeType&&n.host?n.host:n&&n.assignedSlot?n.assignedSlot.parentNode:n}function v(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}}()},function(e,t,n){"use strict";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=!t||t<0?0:+t;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})},function(e,t,n){var r,o,i=n(8),a=n(9),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],f=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:o;if(null==f||null==d){var v=i();null==f&&(f=r=[1|v[0],v[1],v[2],v[3],v[4],v[5]]),null==d&&(d=o=16383&(v[6]<<8|v[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:c+1,g=p-s+(h-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||p>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,c=h,o=d;var m=(1e4*(268435455&(p+=122192928e5))+h)%4294967296;l[u++]=m>>>24&255,l[u++]=m>>>16&255,l[u++]=m>>>8&255,l[u++]=255&m;var y=p/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=d>>>8|128,l[u++]=255&d;for(var b=0;b<6;++b)l[u+b]=f[b];return t||a(l)}},function(e,t,n){var r=n(8),o=n(9);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,n){"use strict";n.r(t),n.d(t,"GetSurfaceContainerId",(function(){return _r})),n.d(t,"Initialize",(function(){return Lr})),n.d(t,"RemoveSurface",(function(){return Yr})),n.d(t,"RenderSurface",(function(){return Go}));n(13);!function(){if("function"!=typeof window.CustomEvent){var e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1],o=void 0===r?{}:r,i=o.bubbles,a=void 0!==i&&i,s=o.cancelable,c=void 0!==s&&s,u=o.detail,l=void 0===u?null:u,f=document.createEvent("CustomEvent");return f.initCustomEvent(n,a,c,l),f};e.prototype=Event.prototype,window.CustomEvent=e}}();n(14);var r,o=n(0);function i(){try{return window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}catch(e){return""}}!function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Unix=3]="Unix",e[e.Linux=4]="Linux"}(r||(r={}));var a,s=(-1===(a=function(){var e=i(),t=-1,n=e.indexOf("MSIE ");if(n>0&&(t=parseInt(e.substring(n+5,e.indexOf(".",n)),10)),e.indexOf("Trident/")>0){var r=e.indexOf("rv:");t=parseInt(e.substring(r+3,e.indexOf(".",r)),10)}return t}())&&(a=function(){var e=i(),t=-1;if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");t=parseInt(e.substring(n+3,e.indexOf(".",n)),10)}return t}()),a>0),c=!1;function u(){return c&&null!==console&&null!==console.log}var l,f,d,v,p,h,g=function(e){if(!e||!Object.assign)return e;var t={};return Object.keys(e).forEach((function(n){"object"==typeof e[n]?Object.assign(t,g(e[n])):t[n]=e[n]})),t};function m(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];u()&&(s?console.log(t,g(n)):console.log("%c%s",e,t,g(n)))}function y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.apply(void 0,Object(o.g)(["color:red",e],t))}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.apply(void 0,Object(o.g)(["color:blue",e],t))}function w(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];u()&&(window&&!("Firebug"in window)?console.assert.apply(console,Object(o.g)([e,t],n)):e||y.apply(void 0,Object(o.g)(["Assertion failure: "+t],n)))}function S(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];u()&&w(e,t,n)}!function(e){e[e.None=0]="None",e[e.Trace=1]="Trace",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(l||(l={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(f||(f={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(d||(d={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(v||(v={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(p||(p={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(h||(h={}));var T,C=function(){var e=this;this.name=function(){return"ConsoleLogSink"},this.beginEvent=function(){return null},this.isLocal=function(){return!0},this.endEvent=function(t,n){S(!n,"Expected context to be null for sink",e.name()),e.writeEntry(t)},this.writeEntry=function(e){if(e.messageData){var t=function(e){switch(e){case l.Info:return"color:green";case l.Warning:return"color:Orange";case l.Error:return"color:red";default:y("Unknown LogLevel: ",e)}return"color:black"}(e.messageData.logLevel),n=e.messageData;m(t,"Log."+l[e.messageData.logLevel],"0x"+n.eventTagId.toString(16),n.message,n.messageDetails)}e.eventActionData&&b("Log.Event:"+e.eventActionData.eventActionType,{tagId:"0x"+e.eventActionData.eventTagId.toString(16)},e.eventActionData,e.customData)}};!function(e){e[e.None=0]="None",e[e.Test=1]="Test",e[e.Dev=2]="Dev",e[e.Edog=3]="Edog",e[e.Int=4]="Int",e[e.Prod=5]="Prod"}(T||(T={}));var E=function(e){switch(e||"production"){case"development":return T.Dev;case"test":return T.Test;default:return T.Prod}},O=function(e,t){var n=t||"production";S(n,"Invalid environment!");var r=e||"";S(r,"Invalid deployment url!");var o=r.toLowerCase(),i=0===o.indexOf("http");T.None;return i?o.indexOf("//localhost:")>=0||o.indexOf("//127.0.0.1:")>=0?T.Dev:o.indexOf("/int/")>=0?T.Int:o.indexOf("/edog/")>=0?T.Edog:T.Prod:"development"===n?T.Dev:"test"===n?T.Test:T.Prod},I=new function(){var e=this;this.config=null,this.setConfiguration=function(t){e.config=t},this.getConfiguration=function(){return e.config},this.isProduction=function(){return E()===T.Prod},this.isTest=function(){return E()===T.Test},this.isDevelopment=function(){return E()===T.Dev}},x=n(5),k=function(){return Object(x.v4)().toString()},_=function(e){return Object(o.b)(void 0,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))},D=(Object.keys,new Date),A=k(),P=function(e){return e===Object(e)},N=D.toISOString();function F(e){return{correlationId:k(),currentTime:(new Date).toISOString(),environment:e?T[e.Environment]:T[T.None],sessionId:e&&e.CustomSessionId?e.CustomSessionId:A,sessionStartTime:N}}function L(){var e=-1,t=window&&window.performance;if(t){var n=t.timeOrigin||t.timing&&t.timing.navigationStart;e=n&&Date.now()-n}return e}function M(){return{windowHeight:window?window.innerHeight:void 0,windowWidth:window?window.innerWidth:void 0}}function j(){return{browserLang:navigator?navigator.language:"Error",browserOnline:!!navigator&&navigator.onLine,browserUserAgent:navigator?navigator.userAgent:"Error",colorDepth:screen?screen.colorDepth:-1,pixelDepth:screen?screen.pixelDepth:-1,screenHeight:screen?screen.height:-1,screenWidth:screen?screen.width:-1}}function B(e,t,n,r){S(e!==l.None,"Invalid logLevel"),w(t>0,"Invalid tagId"),S(n,"Invalid message"),S(r,"Invalid messageDetails");var o=r&&r.length>0?r.map((function(e){return"string"==typeof e?e:V(e)})):void 0,i="string"==typeof n?{eventFlags:void 0,message:n}:n;return{eventFlags:i.eventFlags,eventTagId:t,logLevel:e,message:i.message,messageDetails:o}}var R=function(e,t){e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r&&(P(r)?t(n,JSON.stringify(r)):("string"==typeof r||function(e){return"boolean"==typeof e}(r)||function(e){return"number"==typeof e}(r))&&t(n,r))}))};function U(e,t){S(t,"Invalid callback"),S(e,"Invalid logEntry"),R(e.metadata,t),R(e.messageData,t),R(e.eventActionData,t),R(e.customData,t),R(e.browserData,t)}var H=["name","number","message","description"];function V(e){return JSON.stringify(e,(function(e,t){if(t instanceof Error){var n={name:"",message:""};return Object.getOwnPropertyNames(t).forEach((function(e){var r=e;-1!==H.indexOf(e.toLowerCase())&&(n[r]=t[r])})),n}return t}))}var W=function(e,t){return void 0===t&&(t={dataCategories:d.ProductServicePerformance}),Object(o.a)(Object(o.a)({},t),e)},q=new function(e,t,n){var r=this;void 0===n&&(n=l.Info),this.logSinks=e,this.configuration=t,this.logLevel=n,this.assert=w,this.debug=S,this.clearSinks=function(){r.logSinks=[]},this.setLogLevel=function(e){return r.logLevel=e},this.getLogLevel=function(){return r.logLevel},this.getConfiguration=function(){return r.configuration},this.setConfiguration=function(e){return r.configuration=e},this.updateCustomData=function(e){r.configuration&&(r.configuration.CustomMetadata=Object(o.a)(Object(o.a)({},r.configuration.CustomMetadata),e))},this.addSink=function(e){if(e){var t=r.logSinks.filter((function(t){return t.name()===e.name()}));S(!t||0===t.length,"Sink already exists",e,r.logSinks),t&&t.length>0||r.logSinks.push(e)}else w(e,"Invalid logSink!")},this.removeSinks=function(e){r.logSinks.filter((function(t){return t.name()===e})).forEach((function(e){var t=r.logSinks.indexOf(e);r.logSinks.splice(t,1)}))},this.reserve=function(e){return e},this.trace=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=r.createMessageLogEntry(B(l.Trace,e,t,n));r.writeEntry(i)},this.info=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=r.createMessageLogEntry(B(l.Info,e,t,n));r.writeEntry(i)},this.warn=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=r.createMessageLogEntry(B(l.Warning,e,t,n));r.writeEntry(i)},this.error=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=r.createMessageLogEntry(B(l.Error,e,t,n));r.writeEntry(i)},this.local=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=r.createMessageLogEntry(B(l.Info,68769,e,t));r.writeEntry(o,!0)},this.localWarn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=r.createMessageLogEntry(B(l.Warning,68769,e,t));r.writeEntry(o,!0)},this.instrument=function(e,t,n,i){return void 0===i&&(i={}),Object(o.b)(r,void 0,void 0,(function(){var r,a,s,c,u,l,f=this,d=i.logError,v=void 0===d||d,p=i.onEndEvent,h=i.rethrow,g=void 0===h||h,m=Object(o.f)(i,["logError","onEndEvent","rethrow"]);return Object(o.e)(this,(function(o){switch(o.label){case 0:r=this.beginEvent(e,t,m),m.payloadData||(m.payloadData={}),a=m.payloadData,s=function(){f.endEvent(r,a),p&&p(a.resultType)},c=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n(a)];case 2:return c=o.sent(),a.resultType=a.resultType||"None",s(),[3,4];case 3:if(u=o.sent(),l=u,v&&this.error(592801920,"Instrumentation error handler",e,t,l),a.resultType="Failure",!a.resultInfo&&v&&(a.resultInfo=V(l)),!a.responseCode&&l.code&&(a.responseCode=l.code),s(),g)throw l;return[3,4];case 4:return[2,c]}}))}))},this.event=function(e,t,n){void 0===n&&(n={});var o=r.beginEvent(e,t,n);r.endEvent(o,void 0,!1)},this.userActionEvent=function(e,t,n){var i=void 0===n?{}:n,a=i.customData,s=i.eventFlags,c=i.payloadData;return r.event(e,t,{customData:a,eventFlags:Object(o.a)({dataCategories:d.ProductServiceUsage},s),payloadData:c})},this.beginEvent=function(e,t,n){void 0===n&&(n={}),r.assert(0!==e,"Invalid eventTagId"),r.debug(t,"Invalid eventActionType");var o={};return r.safeEnumerateSinks((function(e){var n=e.beginEvent(t);n&&(o[e.name()]=n)})),{eventActionType:t,eventData:n,eventEnded:!1,eventStartTime:Date.now(),eventTagId:e,sinkContexts:o}},this.beginUserActionEvent=function(e,t,n){var i=void 0===n?{}:n,a=i.customData,s=i.eventFlags,c=i.payloadData;return r.beginEvent(e,t,{customData:a,eventFlags:Object(o.a)({dataCategories:d.ProductServiceUsage},s),payloadData:c})},this.endEvent=function(e,t,n){if(void 0===n&&(n=!0),r.debug(e,"Invalid beginEventData"),r.assert(!e.eventEnded,"Event already ended - "+e.eventActionType),r.debug(e.eventData,"Invalid eventData",e),r.debug(e.eventStartTime,"Invalid eventStartTime",e),r.debug(e.eventActionType,"Invalid eventActionType",e),e&&!e.eventEnded){if(n){var i=e.eventData,a=e.eventStartTime,s=Date.now();i.payloadData=Object(o.a)({responseTime:s-a},i.payloadData)}r.configuration&&r.configuration.CustomMetadata&&(e.eventData.customData=Object(o.a)(Object(o.a)({},r.configuration.CustomMetadata),e.eventData.customData)),e.eventData.payloadData=Object(o.a)(Object(o.a)({},e.eventData.payloadData),t),r.sendEvent(e)}},this.createEventLogEntry=function(e){var t=e.eventTagId,n=e.eventActionType,i=e.eventData,a=i.customData,s=i.eventFlags,c=i.payloadData;return{customData:a,eventActionData:Object(o.a)({eventActionType:n,eventTagId:t},c),eventFlags:W(s),metadata:F(r.configuration)}},this.createMessageLogEntry=function(e){var t=e.eventFlags,n=Object(o.f)(e,["eventFlags"]);return{eventFlags:W(t),messageData:n,metadata:F(r.configuration)}},this.writeEntry=function(e,t){void 0===t&&(t=!1),e.messageData&&e.messageData.logLevel<r.logLevel||r.safeEnumerateSinks((function(t){t.writeEntry(e)}),t)},this.sendEvent=function(e){var t=r.createEventLogEntry(e),n=e.sinkContexts;r.safeEnumerateSinks((function(e){e.endEvent(t,n[e.name()])})),e.eventEnded=!0},this.safeEnumerateSinks=function(e,t){if(void 0===t&&(t=!1),S(e&&r.logSinks,"Invalid input",e,r.logSinks),e&&r.logSinks)for(var n=0,o=r.logSinks;n<o.length;n++){var i=o[n];try{(!t||i.isLocal&&i.isLocal())&&e(i)}catch(t){S(!1,"Error with callback",t,i,e)}}}}([]);function z(e){var t="";if(void 0!==e){var n=document.querySelector('script[src^="'+e+'"]');n&&(t=n.getAttribute("src"))}return t||void 0}function K(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}var G,J,X,Q,Z=n(1);!function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(G||(G={})),function(e){var t={},n={},r={};function o(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=function e(t,n){if("object"!=typeof n)return n;for(var r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];i in t&&(t[i],1)?t[i]=e(t[i],n[i]):t[i]=n[i]}return t}(r,e)}function i(e){if(t[e])return t[e];var n=s(e,G.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function a(e){if(n[e])return n[e];var t=s(e,G.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),o=r,i=void 0;if(o){for(var a=0;a<n.length-1;a++)o[n[a]]&&(o=o[n[a]],t===G.Aria&&"string"==typeof o.ariaTenantToken?i=o.ariaTenantToken:t===G.Nexus&&"number"==typeof o.nexusTenantToken&&(i=o.nexusTenantToken));return i}}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])Object(Z.d)(Z.b.Error,Z.a.Core,(function(){return"Invalid namespace: "+e}));else{var i=Object.create(Object.prototype);t&&(i.ariaTenantToken=t),n&&(i.nexusTenantToken=n);var a,s=i;for(a=r.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[r[a]]=s,s=c}o(s)}},e.setTenantTokens=o,e.getTenantTokens=function(e){var t=i(e),n=a(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=i,e.getNexusTenantToken=a,e.clear=function(){t={},n={},r={}}}(J||(J={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(X||(X={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&n.test(e)}function o(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===X.Int64&&i(e.value)}function i(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),r=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(o=r,void 0!==o&&t.test(o));var o}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)o(e.dataFields[n])},e.validateInt=i}(Q||(Q={}));var $=n(6),Y=n(4);function ee(e,t){return{name:e,dataType:X.Boolean,value:t,classification:Y.a.SystemMetadata}}function te(e,t){return{name:e,dataType:X.Int64,value:t,classification:Y.a.SystemMetadata}}function ne(e,t){return{name:e,dataType:X.String,value:t,classification:Y.a.SystemMetadata}}var re,oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ie=function(){function e(e,t,n){var r,o;this.onSendEvent=new $.a,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=oe(oe({},e.getConfig()),this.config)):this.persistentDataFields.push(ne("OTelJS.Version","3.1.69")),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void Object(Z.d)(Z.b.Warning,Z.a.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void Object(Z.c)(Z.a.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=J.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||Q.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){J.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){J.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return K(e)},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(re||(re={}));var ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},se=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ce=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(ce=function(){return 1e3*Math.floor(window.performance.now())});var ue,le,fe,de,ve,pe,he,ge,me,ye=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?re.getNextChild(n._cv):re.getNext(),this._dataFields=[],this._success=void 0,this._startTime=ce()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&Object(Z.d)(Z.b.Warning,Z.a.Core,(function(){return"Activity does not have success or result set"}));var e=ce()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}Object(Z.d)(Z.b.Error,Z.a.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return ae(this,void 0,void 0,(function(){var t=this;return se(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return ae(this,void 0,void 0,(function(){return se(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function be(e,t,n){e.push(ne("zC."+t,n))}(ue||(ue={})).getFields=function(e,t){var n=[];return n.push(te(e+".Code",t.code)),void 0!==t.type&&n.push(ne(e+".Type",t.type)),void 0!==t.tag&&n.push(te(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(ee(e+".IsExpected",t.isExpected)),be(n,e,"Office.System.Result"),n},(fe=le||(le={})).contractName="Office.System.Activity",fe.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(ne("Activity.CV",e.cV)),t.push(te("Activity.Duration",e.duration)),t.push(te("Activity.Count",e.count)),t.push(te("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(ee("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,ue.getFields("Activity.Result",e.result)),be(t,"Activity",fe.contractName),t},(de||(de={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(ne(e+".Id",t.id)),void 0!==t.version&&n.push(ne(e+".Version",t.version)),void 0!==t.sessionId&&n.push(ne(e+".SessionId",t.sessionId)),be(n,e,"Office.System.Host"),n},(ve||(ve={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(ne(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(ne(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(ne(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(ne(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(ne(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(ee(e+".IsAnonymous",t.isAnonymous)),be(n,e,"Office.System.User"),n},(pe||(pe={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(ne(e+".Id",t.id)),void 0!==t.version&&n.push(ne(e+".Version",t.version)),void 0!==t.instanceId&&n.push(ne(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(ne(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(ne(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(ne(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(ne(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(ne(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(ne(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(ne(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(ne(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(ne(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(ne(e+".Type",t.type)),be(n,e,"Office.System.SDX"),n},(he||(he={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(ne(e+".Name",t.name)),void 0!==t.state&&n.push(ne(e+".State",t.state)),be(n,e,"Office.System.Funnel"),n},(ge||(ge={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(te(e+".Id",t.id)),void 0!==t.name&&n.push(ne(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(ne(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(ne(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(ne(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(te(e+".TimeOffsetMs",t.timeOffsetMs)),be(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(ne(e+".ErrorGroup",t.errorGroup)),n.push(te(e+".Tag",t.tag)),void 0!==t.code&&n.push(te(e+".Code",t.code)),void 0!==t.id&&n.push(te(e+".Id",t.id)),void 0!==t.count&&n.push(te(e+".Count",t.count)),be(n,e,"Office.System.Error"),n}}(me||(me={}));var we,Se=le,Te=ue,Ce=me,Ee=he,Oe=de,Ie=pe,xe=ge,ke=ve;!function(e){!function(e){!function(e){e.Activity=Se,e.Result=Te,e.Error=Ce,e.Funnel=Ee,e.Host=Oe,e.SDX=Ie,e.User=ke,e.UserAction=xe}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(we||(we={}));var _e,De=(_e=function(e,t){return(_e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}_e(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Pe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return De(t,e),t.prototype.executeActivityAsync=function(e,t){return Ae(this,void 0,void 0,(function(){return Pe(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return ye.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:we.Office.System.Activity.contractName,dataFields:we.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=we.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(ie),Fe=Object,Le=Fe.getPrototypeOf,Me=0;function je(e,t){return e&&Fe.prototype.hasOwnProperty.call(e,t)}function Be(e){return e&&(e===Fe.prototype||e===Array.prototype)}function Re(e){return Be(e)||e===Function.prototype}function Ue(e){if(e){if(Le)return Le(e);var t=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(t)return t}return null}function He(e,t){var n=[],r=Fe.getOwnPropertyNames;if(r)n=r(e);else for(var o in e)"string"==typeof o&&je(e,o)&&n.push(o);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function Ve(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||je(e,t))}function We(e){throw new TypeError("DynamicProto: "+e)}function qe(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function ze(e,t,n,r){var o=null;if(e&&je(n,"_dynClass")){var i=e._dynInstFuncs||{};if((o=(i[n._dynClass]||{})[t])||We("Missing ["+t+"] function"),!o._dynInstChk&&!1!==i._dynInstChk){for(var a=!je(e,t),s=Ue(e),c=[];a&&s&&!Re(s)&&!qe(c,s);){var u=s[t];if(u){a=u===r;break}c.push(s),s=Ue(s)}try{a&&(e[t]=o),o._dynInstChk=1}catch(e){i._dynInstChk=!1}}}return o}function Ke(e,t,n){var r=t[e];return r===n&&(r=Ue(t)[e]),"function"!=typeof r&&We("["+e+"] is not a function"),r}function Ge(e,t,n,r,o){if(!Be(e)){var i=n._dynInstFuncs=n._dynInstFuncs||{},a=i[t]=i[t]||{};!1!==i._dynInstChk&&(i._dynInstChk=!!o),He(n,(function(t){Ve(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!je(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var r=ze(this,t,e,n)||Ke(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function Je(e,t){return je(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function Xe(e,t,n,r){je(e,"prototype")||We("theClass is an invalid class definition.");var o=e.prototype;(function(e,t){if(Le)for(var n=[],r=Ue(t);r&&!Re(r)&&!qe(n,r);){if(r===e)return!0;n.push(r),r=Ue(r)}return!1})(o,t)||We("["+Je(e)+"] is not in class hierarchy of ["+Je(t)+"]");var i=null;je(o,"_dynClass")?i=o._dynClass:(i="_dynCls$"+Je(e,"_")+"$"+Me,Me++,o._dynClass=i);var a=Xe._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var c=function(e){var t={};return He(e,(function(n){!t[n]&&Ve(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function o(e,t,n){var o=t[n];if(o._isDynProxy&&r){var i=e._dynInstFuncs||{};!1!==i._dynInstChk&&(o=(i[t._dynClass]||{})[n]||o)}return function(){return o.apply(e,arguments)}}var i={};He(n,(function(e){i[e]=o(t,n,e)}));for(var a=Ue(e),s=[];a&&!Re(a)&&!qe(s,a);)He(a,(function(e){!i[e]&&Ve(a,e,!Le)&&(i[e]=o(t,a,e))})),s.push(a),a=Ue(a);return i}(o,t,c,s));var u=!!Le&&!!a.setInstFuncs;u&&r&&(u=!!r.setInstFuncs),Ge(o,i,t,c,!1!==u)}Xe._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Qe=Xe;function Ze(){return"undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window||"undefined"!=typeof window&&window?window:null}function $e(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if("object"!==n&&"function"!==n)throw new TypeError("Object prototype may only be an Object:"+e);function r(){}return r.prototype=e,new r}var Ye=function(e,t){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var et,tt,nt,rt=Ze()||{};tt=function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},nt=function(e,t){function n(){this.constructor=e}Ye(e,t),e.prototype=null===t?$e(t):(n.prototype=t.prototype,new n)},(et=rt).__assign||(et.__assign=Object.assign||tt),et.__extends||(et.__extends=nt),__assign||(__assign=rt.__assign),__extends||(__extends=rt.__extends);var ot=Ze;function it(e){var t=ot();return t&&t[e]?t[e]:"window"===e&&at()?window:null}function at(){return Boolean("object"==typeof window&&window)}function st(){return at()?window:it("window")}function ct(){return Boolean("object"==typeof document&&document)?document:it("document")}function ut(){return Boolean("object"==typeof navigator&&navigator)}function lt(){return ut()?navigator:it("navigator")}function ft(){return"object"==typeof location&&location?location:it("location")}function dt(){return Boolean("object"==typeof JSON&&JSON||null!==it("JSON"))}var vt=null,pt=!1,ht=123456789,gt=987654321;function mt(e){e<0&&(e>>>=0),ht=123456789+e&4294967295,gt=987654321-e&4294967295,pt=!0}function yt(){mt(4294967296*Math.random()^(new Date).getTime())}function bt(e,t){return typeof e===t}function wt(e){return bt(e,"undefined")||void 0===e}function St(e){return wt(e)||null===e}function Tt(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function Ct(e){return bt(e,"object")}function Et(e){return bt(e,"function")}function Ot(e,t,n,r){void 0===r&&(r=!1);var o=!1;if(!St(e))try{St(e.addEventListener)?St(e.attachEvent)||(e.attachEvent("on"+t,n),o=!0):(e.addEventListener(t,n,r),o=!0)}catch(e){}return o}function It(e,t,n,r){if(void 0===r&&(r=!1),!St(e))try{St(e.removeEventListener)?St(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}function xt(e,t,n,r){var o=Object.defineProperty;if(o)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),o(e,t,i),!0}catch(e){}return!1}var kt,_t=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},e.isString=function(e){return bt(e,"string")},e.isNumber=function(e){return bt(e,"number")},e.isBoolean=function(e){return bt(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Dt,(function(t){var n=0|e.randomValue(15);return("x"===t?n:3&n|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var r=e.length,o=0;o<r;o++)o in e&&t.call(n||e,e[o],o,e)},e.arrIndexOf=function(e,t,n){for(var r=e.length,o=n||0,i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;i++)if(i in e&&e[i]===t)return i;return-1},e.arrMap=function(e,t,n){for(var r=e.length,o=n||e,i=new Array(r),a=0;a<r;a++)a in e&&(i[a]=t.call(o,e[a],e));return i},e.arrReduce=function(e,t,n){var r,o=e.length,i=0;if(arguments.length>=3)r=arguments[2];else{for(;i<o&&!(i in e);)i++;r=e[i++]}for(;i<o;)i in e&&(r=t(r,e[i],i,e)),i++;return r},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(Et(e)||Ct(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)Tt(e,r)&&n.push(r);if(t)for(var o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=o.length,a=0;a<i;a++)Tt(e,o[a])&&n.push(o[a]);return n},e.addEventHandler=function(e,t){var n=!1,r=st();r&&(n=Ot(r,e,t),n=Ot(r.body,e,t)||n);var o=ct();return o&&(n=At.Attach(o,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=it("performance");return t&&t.now?t.now():e.dateNow()},e.newId=function(t){void 0===t&&(t=22);for(var n=e.random32()>>>0,r=0,o="";o.length<t;)r++,o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===r&&(n=(e.random32()<<2&4294967295|3&n)>>>0,r=0);return o},e.isIE=function(){if(null===vt){var e=((lt()||{}).userAgent||"").toLowerCase();vt=-1!==e.indexOf("msie")||-1!==e.indexOf("trident/")}return vt},e.randomValue=function(t){return t>0?Math.floor(e.random32()/4294967295*(t+1))>>>0:0},e.random32=function(t){var n,r=it("crypto")||it("msCrypto");return r&&r.getRandomValues?n=4294967295&r.getRandomValues(new Uint32Array(1))[0]:e.isIE()?(pt||yt(),n=4294967295&e.mwcRandom32()):n=Math.floor(4294967296*Math.random()|0),t||(n>>>=0),n},e.mwcRandomSeed=function(e){e?mt(e):yt()},e.mwcRandom32=function(e){var t=((gt=36969*(65535&gt)+(gt>>16)&4294967295)<<16)+(65535&(ht=18e3*(65535&ht)+(ht>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t},e.generateW3CId=function(){for(var t,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",o=0;o<4;o++)r+=n[15&(t=e.random32())]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var i=n[8+(3&e.random32())|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+i+r.substr(16,3)+r.substr(19,12)},e.isTypeof=bt,e.isUndefined=wt,e.isNullOrUndefined=St,e.hasOwnProperty=Tt,e.isFunction=Et,e.isObject=Ct,e.objCreate=$e,e.objDefineAccessors=xt,e}(),Dt=/[xy]/g,At=function(){function e(){}return e.Attach=Ot,e.AttachEvent=Ot,e.Detach=It,e.DetachEvent=It,e}(),Pt=function(){function e(t,n,r){var o,i=this,a=!1;(i.start=_t.dateNow(),i.name=t,i.isAsync=r,i.isChildEvt=function(){return!1},_t.isFunction(n))&&(a=_t.objDefineAccessors(i,"payload",(function(){return!o&&_t.isFunction(n)&&(o=n(),n=null),o})));i.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?i[t]:(i.ctx||{})[t]:null},i.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)i[t]||(i.isChildEvt=function(){return!0}),i[t]=n;else if(t===e.ChildrenContextKey)i[t]=n;else{(i.ctx=i.ctx||{})[t]=n}},i.complete=function(){var t=0,r=i.getCtx(e.ChildrenContextKey);if(_t.isArray(r))for(var o=0;o<r.length;o++){var s=r[o];s&&(t+=s.time)}i.time=_t.dateNow()-i.start,i.exTime=i.time-t,i.complete=function(){},!a&&_t.isFunction(n)&&(i.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Nt=function(){function e(t){this.ctx={},Qe(e,this,(function(e){e.create=function(e,t,n){return new Pt(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}();function Ft(e,t,n,r,o){if(e){var i=e;if(i&&_t.isFunction(i.getPerfMgr)&&(i=i.getPerfMgr()),i){var a=void 0,s=i.getCtx("CoreUtils.doPerf");try{if(a=i.create(t(),r,o)){if(s&&a.setCtx&&(a.setCtx(Pt.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Pt.ChildrenContextKey);c||(c=[],s.setCtx(Pt.ChildrenContextKey,c)),c.push(a)}return i.setCtx("CoreUtils.doPerf",a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&i.fire(a),i.setCtx("CoreUtils.doPerf",s)}}}return n()}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(kt||(kt={}));var Lt={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103};function Mt(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var jt=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var o="";dt()&&(o=(dt()?JSON||it("JSON"):null).stringify(r));var i=(t?" message:"+Mt(t):"")+(r?" props:"+Mt(o):"");this.message+=i}return e.dataType="MessageData",e}(),Bt=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};Qe(e,this,(function(e){var o=_t.isNullOrUndefined,i=_t.isUndefined,a=_t.isFunction;function s(e,n){var r=t[e];return o(r)?n:r}o(t)&&(t={}),e.consoleLoggingLevel=function(){return s("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return s("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return s("maxMessageLimit",25)},e.enableDebugExceptions=function(){return s("enableDebugExceptions",!1)},e.throwInternal=function(t,n,o,a,s){void 0===s&&(s=!1);var c=new jt(n,o,s,a);if(e.enableDebugExceptions())throw c;if(!i(c)&&c&&!i(c.message)){if(s){var u=+c.messageId;!r[u]&&e.consoleLoggingLevel()>=kt.WARNING&&(e.warnToConsole(c.message),r[u]=!0)}else e.consoleLoggingLevel()>=kt.WARNING&&e.warnToConsole(c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){var t="undefined"!=typeof console?console:it("console");if(t){var n="log";t.warn&&(n="warn"),a(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,o){if(!(n>=e.maxInternalMessageLimit())){var i=!0,a="AITR_"+o.messageId;if(r[a]?i=!1:r[a]=!0,i&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(o),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new jt(Lt.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,r,o){void 0===o&&(o=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),Rt=_t.isFunction,Ut=function(e,t){var n=this,r=null,o=Rt(e.processTelemetry),i=Rt(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";Ft(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&o){n._hasRun=!0;try{s.setNext(r),i&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(kt.CRITICAL,Lt.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}},Ht=_t.isNullOrUndefined;function Vt(e,t){var n=[];if(e&&e.length>0)for(var r=null,o=0;o<e.length;o++){var i=e[o];if(i&&_t.isFunction(i.processTelemetry)){var a=new Ut(i,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var Wt=function e(t,n,r,o){var i=this,a=null;null!==o&&(t&&_t.isFunction(t.getPlugin)?a=function(e,t,n){var r=[],o=!n;if(e)for(;e;){var i=e.getPlugin();(o||i===n)&&(o=!0,r.push(i)),e=e.getNext()}return o||r.push(n),Vt(r,t)}(t,i,o||t.getPlugin()):o?a=function(e,t,n){var r=e,o=!1;return n&&e&&(r=[],_t.arrForEach(e,(function(e){(o||e===n)&&(o=!0,r.push(e))}))),n&&!o&&(r||(r=[]),r.push(n)),Vt(r,t)}(t,i,o):_t.isUndefined(o)&&(a=Vt(t,i))),i.core=function(){return r},i.diagLog=function(){var e=(r||{}).logger;return e||(e=new Bt(n||{})),e},i.getCfg=function(){return n},i.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var o=n.extensionConfig;o&&e&&(r=o[e])}return r||t},i.getConfig=function(e,t,r){var o;void 0===r&&(r=!1);var a=i.getExtCfg(e,null);return a&&!Ht(a[t])?o=a[t]:n&&!Ht(n[t])&&(o=n[t]),Ht(o)?r:o},i.hasNext=function(){return null!=a},i.getNext=function(){return a},i.setNext=function(e){a=e},i.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,i))},i.createNew=function(t,o){return void 0===t&&(t=null),new e(t||a,n,r,o)}},qt=_t.isFunction,zt=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&qt(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var o=t;if(!o){var i=n||new Wt(null,{},e.core);o=r&&r.getPlugin?i.createNew(null,r.getPlugin):i.createNew(null,r)}return o},e._baseTelInit=function(o,i,a,s){o&&(o.extensionConfig=o.extensionConfig||[]),!s&&i&&(s=i.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=i,n=new Wt(s,o,i,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),Kt=_t.isFunction;function Gt(e,t){for(var n=[],r=null,o=e.getNext();o;){var i=o.getPlugin();i&&(r&&Kt(r.setNextPlugin)&&Kt(i.processTelemetry)&&r.setNextPlugin(i),Kt(i.isInitialized)&&i.isInitialized()||n.push(i),r=i,o=o.getNext())}_t.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function Jt(e){return e.sort((function(e,t){var n=0,r=Kt(t.processTelemetry);return Kt(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var Xt=_t.objDefineAccessors,Qt=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=500;var r,o=_t.arrForEach;function i(e){e&&e.length>0&&(function(e){o(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),r.push(e))}return Qe(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&o(r,(function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)}))},e.getChannelControls=function(){return r},e.initialize=function(n,a,s){e.isInitialized()||(t.initialize(n,a,s),n.isCookieUseDisabled&&_t.disableCookies(),function(e,t){r=[],e&&o(e,(function(e){return i(e)}));if(t){var n=[];o(t,(function(e){e.priority>500&&n.push(e)})),i(n)}}((n||{}).channels,s),o(r,(function(e){return Gt(new Wt(e,n,a),s)})))}})),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(Xt(t.prototype,"ChannelControls",t.prototype.getChannelControls),void Xt(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(zt),Zt=_t.arrForEach,$t=_t.isNullOrUndefined,Yt=function(){function e(){var t,n,r,o,i=!1;Qe(e,this,(function(e){e._extensions=new Array,n=new Qt,e.logger=_t.objCreate({throwInternal:function(e,t,n,r,o){void 0===o&&(o=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return i},e.initialize=function(t,o,a,s){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||$t(t.instrumentationKey))throw Error("Please provide instrumentation key");r=s,e._notificationManager=s,e.config=t||{},t.extensions=$t(t.extensions)?[]:t.extensions,(t.extensionConfig=$t(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,a&&(e.logger=a);var c=[];c.push.apply(c,o.concat(t.extensions)),c=Jt(c);var u=[],l=[],f={};if(Zt(c,(function(e){if($t(e)||$t(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&($t(f[t])?f[t]=r:a.warnToConsole("Two extensions have same priority #"+t+" - "+f[t]+", "+r)),!t||t<n.priority?u.push(e):l.push(e)})),c.push(n),u.push(n),c=Jt(c),e._extensions=c,Gt(new Wt([n],t,e),c),Gt(new Wt(u,t,e),c),e._extensions=u,0===e.getTransmissionControls().length)throw new Error("No channels available");i=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=_t.toISOString(new Date)),$t(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new Wt(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=_t.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getPerfMgr=function(){return o||e.config&&e.config.enablePerfMgr&&(o=new Nt(e.getNotifyMgr())),o},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Zt(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))}return e.prototype.initialize=function(e,t,n,r){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),en=0,tn=1,nn=2,rn=4,on=5,an=function(){function e(t){this.listeners=[];var n=_t.arrForEach,r=!!(t||{}).perfEvtsSendAll;Qe(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=_t.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=_t.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,r){n(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,r)}),0)}))},e.eventsSendRequest=function(t,r){n(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(r)setTimeout((function(){return e.eventsSendRequest(t,r)}),0);else try{e.eventsSendRequest(t,r)}catch(e){}}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||n(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),sn=function(e){function t(){var n=e.call(this)||this;return Qe(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],nn)}e.initialize=function(e,n,r,o){t.initialize(e,n,r||new Bt(e),o||new an(e))},e.track=function(r){Ft(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===r)throw n(r),Error("Invalid telemetry item");!function(e){if(_t.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];_t.arrForEach(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:_t.toISOString(new Date),baseType:jt.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(Yt),cn=1,un=2,ln=3,fn={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},dn=__assign({},Lt,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519}),vn=fn,pn=null;var hn=_t.isUndefined,gn=_t.isNullOrUndefined;function mn(e){return!hn(e)}_t.hasOwnProperty;var yn,bn=null,wn=_t.arrForEach,Sn=(_t.arrIndexOf,_t.arrMap,_t.arrReduce,_t.objKeys),Tn=(_t.toISOString,function(){var e=lt();return!(!e||!e.product)&&"ReactNative"===e.product}),Cn=_t.isString,En=_t.isNumber,On=_t.isBoolean,In=(_t.isFunction,_t.isArray),xn=(_t.isObject,_t.strTrim),kn=(Boolean(ct()),Boolean(st()));function _n(e){return!(gn(e)||""===e)}function Dn(){return null===bn&&(bn=ut()&&Boolean(lt().sendBeacon)),bn}function An(e,t,n){if(!Cn(e)||gn(t)||""===t)return null;if(Cn(t)||En(t)||On(t)||In(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(gn(t.value)||""===t.value||!Cn(t.value)&&!En(t.value)&&!On(t.value)&&!In(t.value))return null}else t={value:n?JSON.stringify(t):t};if(In(t.value)&&!(t.value.length>0))return null;if(mn(t.kind)){if(In(t.value)||!function(e){if(En(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function Pn(e,t,n){var r=-1;return hn(e)?r:(t&&t>0&&(32===t?r=1<<13:t<=13&&(r=t<<5)),mn(n)&&function(e){if(En(e)&&e>=0&&e<=9)return!0;return!1}(n)?(-1===r&&(r=0),r|n):(In(e)&&(e=e[0]),-1!==r?r|function(e){if(hn(e))return-1;if(En(e))return vn.Double;if(Cn(e))return vn.String;if(On(e))return vn.Bool;return-1}(e):En(e)?vn.Double:r))}function Nn(){if(void 0===yn){yn=!1;try{var e=ct(),t=lt();e&&!hn(e.cookie)&&t&&t.cookieEnabled&&(yn=!0)}catch(e){}}return yn}function Fn(e,t,n){if(Nn()){var r="",o=ft();o&&"https:"===o.protocol&&(r=";secure",null===pn&&(s=(lt()||{}).userAgent,pn=!!Cn(s)&&(-1!==s.indexOf("CPU iPhone OS 12")||-1!==s.indexOf("iPad; CPU OS 12")||-1!==s.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==s.indexOf("Version/")&&-1!==s.indexOf("Safari")||!(-1===s.indexOf("Macintosh; Intel Mac OS X 10_14")||!function(e,t){var n=e.length,r=n-t.length;return e.substring(r>=0?r:0,n)===t}(s,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||-1!==s.indexOf("Chrome/5")||-1!==s.indexOf("Chrome/6")||-1!==s.indexOf("UnrealEngine")&&-1===s.indexOf("Chrome")||-1!==s.indexOf("UCBrowser/12")||-1!==s.indexOf("UCBrowser/11"))),pn||(t+=";SameSite=None"));var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var a="; expires="+i.toUTCString();ct().cookie=e+"="+t+a+"; path=/"+r}var s}var Ln=_t.perfNow;function Mn(e){return e<10?"0"+e:e.toString()}function jn(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Ln()}var Bn=_t.addEventHandler,Rn=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",Qe(t,n,(function(e,t){e.initialize=function(n,r,o,i){Ft(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw"Invalid property storage override passed.";n.channels&&wn(n.channels,(function(t){t&&wn(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&wn(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,o,i)}catch(t){e.logger.throwInternal(kt.CRITICAL,dn.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:r,logger:o,notificationManager:i}}))},e.track=function(n){Ft(e,(function(){return"AppInsightsCore.track"}),(function(){var r,o=n;if(o){o.timings=o.timings||{},o.timings.trackStart=Ln(),(r=o.latency)&&En(r)&&r>=1&&r<=3||(o.latency=cn);var i=o.ext=o.ext||{};i.sdk=i.sdk||{},i.sdk.ver="1DS-Web-JS-2.4.6";var a=o.baseData=o.baseData||{};a.properties||(a.properties={});var s=a.properties;s.version||(s.version=""),""!=e.pluginVersionString&&(s.version=e.pluginVersionString)}t.track(o)}),(function(){return{item:n}}),!n.sync)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t}(sn),Un=function(){function e(t,n){var r=n?[].concat(n):[],o=_t.isNullOrUndefined;Qe(e,this,(function(n){n.iKey=function(){return t},n.count=function(){return r.length},n.events=function(){return r},n.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(r=t?r.concat(e):e.concat(r),e.length):0},n.split=function(n,i){var a=new e(t);if(n<r.length){var s=r.length-n;o(i)||(s=i<s?i:s),a.addEvents(r.splice(n,s))}return a}}))}return e.create=function(t,n){return new e(t,n)},e}(),Hn=Math.min(2e6,65e3),Vn=function e(t){Qe(e,this,(function(e){e.createPayload=function(e,t,n,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r}},e.appendPayload=function(n,r,o){var i=n&&r&&!n.overflow;return i&&Ft(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),i=n.payloadBlob,a=n.numEvents,s=!1,c=[],u=n.isBeacon,l=u?65e3:3984588,f=u?Hn:2e6,d=0;d<t.length;){var v=t[d];if(v){if(a>=o){n.overflow=r.split(d);break}var p=e.getEventBlob(v);if(p.length<=f){var h=p.length;if(i.length+h>l){n.overflow=r.split(d);break}i&&(i+="\n"),i+=p,s=!0,a++}else c.concat(t.slice(d,1))}d++}if(c&&c.length>0&&n.sizeExceed.push(Un.create(r.iKey(),c)),s){n.batches.push(r),n.payloadBlob=i,n.numEvents=a;var g=r.iKey();-1===_t.arrIndexOf(n.apiKeys,g)&&n.apiKeys.push(g)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:o}})),i},e.getEventBlob=function(e){return Ft(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};return t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey),e.ext&&(t.ext={},wn(Sn(e.ext),(function(n){t.ext[n]={},wn(Sn(e.ext[n]),(function(r){_n(e.ext[n][r])&&(t.ext[n][r]=An(r,e.ext[n][r]).value)}))}))),t.data={},t.data.baseData={},t.data.baseType=e.baseType,e.baseData&&wn(Sn(e.baseData),(function(n){var r=An(n,e.baseData[n]);Wn(t.data.baseData,n,r),qn(t.ext,"baseData."+n,r)})),e.data&&wn(Sn(e.data),(function(n){var r=An(n,e.data[n]);Wn(t.data,n,r),qn(t.ext,n,r)})),JSON.stringify(t)}),(function(){return{item:e}}))}}))};function Wn(e,t,n){if(n){for(var r=e,o=t.split("."),i=0;i<o.length-1;++i)r[o[i]]||(r[o[i]]={}),r=r[o[i]];r[o[o.length-1]]=n.value}}function qn(e,t,n){if(n){var r=Pn(n.value,n.kind,n.propertyType);if(r>-1){var o=e;o.metadata||(o.metadata={}),o.metadata.f||(o.metadata.f={}),o=o.metadata.f;for(var i=t.split("."),a=0;a<i.length-1;++a)o[i[a]]||(o[i[a]]={f:{}}),o=o[i[a]].f;In(n.value)?o[i[i.length-1]]={a:{t:r}}:o[i[i.length-1]]={t:r}}}}var zn=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),Kn=function e(){var t={};Qe(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(a=e.split(","),s=[],a&&wn(a,(function(e){s.push(xn(e))})),s);if("this-request-only"===n)return r;for(var o=1e3*parseInt(n,10),i=0;i<r.length;++i)t[r[i]]=_t.dateNow()+o}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,r=xn(e);return void 0!==n[r]&&n[r]>_t.dateNow()||(delete n[r],!1)}}))},Gn=function e(){var t=!0,n=!0,r=!0,o="use-collector-delta",i=!1;Qe(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,i||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return o},e.setClockSkew=function(e){i||(e?(o=e,n=!0,i=!0):n=!1,t=!0)}}))},Jn=((Qn={})[1]="requeue",Qn[100]="requeue",Qn[200]="sent",Qn[8004]="drop",Qn[8003]="drop",Qn);function Xn(e){try{return e.responseText}catch(e){}return""}var Qn,Zn,$n,Yn,er,tr,nr=function e(t,n,r,o){this._responseHandlers=[];var i,a,s,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-2.4.6",u=new Kn,l=!1,f=new Gn,d=!1,v=0,p=!0,h=[],g={},m=[],y=null,b=!0;Qe(e,this,(function(e){var w=!0;function S(e,t){var n=new XDomainRequest;n.open("POST",e.urlString),n.onload=function(){var e=Xn(n);E(t,200,{},e),M(e)},n.onerror=function(){E(t,400,{})},n.ontimeout=function(){E(t,500,{})},n.send(e.data)}function T(e,t){var n;fetch(e.urlString,(n={body:e.data,method:"POST",credentials:"include"},n.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n.headers=e.headers,n)).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),E(t,e.status,n,r),M(r)})).catch((function(e){E(t,0,{})}))}function C(e,t,n){function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=xn(r))}return e}function o(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(Cn(e)){var n=xn(e).split(/[\r\n]+/);wn(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=xn(e.substring(0,n)).toLowerCase(),o=xn(e.substring(n+1));t[r]=o}else t[xn(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=r(t,e,"time-delta-millis"),t=r(t,e,"kill-duration"),t=r(t,e,"kill-duration-seconds")),t}function i(e,n){E(t,e.status,o(e),n)}var a=new XMLHttpRequest;try{a.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(e){}w&&(a.withCredentials=!0),a.open("POST",e.urlString,!n),wn(Sn(e.headers),(function(t){a.setRequestHeader(t,e.headers[t])})),a.onload=function(){var e=Xn(a);i(a,e),M(e)},a.onerror=function(){i(a)},a.ontimeout=function(){i(a)},a.send(e.data)}function E(e,t,n,r){try{e(t,n,r)}catch(e){i.diagLog().throwInternal(kt.WARNING,dn.SendPostOnCompleteFailure,e)}}function O(){return!l&&v<n}function I(){var e=m;return m=[],e}function x(e,t,n){var r=!1;return e&&e.length>0&&!l&&a&&y&&(r=t||O()&&(n>0||f.allowRequestSending())),r}function k(e){var t={};return e&&wn(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function _(e,n,r,o,i,a){if(e&&0!==e.length)if(l)j(e,1,o);else{var c=e;Ft(s,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var c=[],l=null,f=Ln();x(e,o,n);){var d=e.shift();d&&d.count()>0&&(u.isTenantKilled(d.iKey())?c.push(d):(l=l||y.createPayload(n,r,o,a&&A()),y.appendPayload(l,d,t)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,N(l,f,Ln(),i),f=Ln(),l=null):(N(l,f,Ln(),i),f=Ln(),e=[d].concat(e),l=null)))}l&&N(l,f,Ln(),i),e.length>0&&(m=e.concat(m)),j(c,8004,o)}),(function(){return{batches:k(c),retryCount:n,isTeardown:r,isSynchronous:o,sendReason:i,useSendBeacon:a}}),!o)}}function D(e){var t=c,n="";wn(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+_t.dateNow().toString();var r=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),r=0;r<n.length;r++){var o=(n[r].ext||{}).intweb||{};if(_n(o.msfpc))return encodeURIComponent(o.msfpc)}return""}(e);if(_n(r)&&(t=t+"&ext.intweb.msfpc="+r),f.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+f.getClockSkewHeaderValue()),s.getWParam){var o=s.getWParam();o>=0&&(t+="&w="+o)}for(var i=0;i<h.length;i++)t+="&"+h[i].name+"="+h[i].value;return t}function A(){return!p&&d&&Dn()}function P(e,t,n){e[t]=e[t]||{},e[t][i.identifier]=n}function N(t,n,o,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=D(t),d=Ln();Ft(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){wn(t.batches,(function(e){wn(e.events(),(function(e){if(b){var t=e.timings=e.timings||{};P(t,"sendEventStart",d),P(t,"serializationStart",n),P(t,"serializationCompleted",o)}e.sendAttempt>0?e.sendAttempt++:e.sendAttempt=1}))})),j(t.batches,1e3+(c||0),t.isSync,!0);var p={data:t.payloadBlob,urlString:l,headers:g};t.payloadBlob=null;var h=null,m=!!e.sendHook;A()&&t.isBeacon?(m=!1,h=function(n){!function(e,t,n){try{if(Dn()){var r=lt();if(r.sendBeacon(e.urlString,e.data))return void F(t,200,n,!1);wn(t.batches,(function(e){null.push(e.split(0))})),F(t,200,n,!1),j(null,8003,t.isSync,!0)}}catch(e){i.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(n,t,c),e.sendListener&&e.sendListener(p,n,t.isSync||t.isTeardown,!0)}):a&&(h=function(n){f.firstRequestSent();var o=function(e,n){!function(e,t,n,o){var i=9e3,a=null,s=!1,c=!1;try{var l=!0;if(void 0!==e){if(t){f.setClockSkew(t["time-delta-millis"]);var d=t["kill-duration"]||t["kill-duration-seconds"];wn(u.setKillSwitchTenants(t["kill-tokens"],d),(function(e){wn(n.batches,(function(t){if(t.iKey()===e){a=a||[];var r=t.split(0);n.numEvents-=r.count(),a.push(r)}}))}))}if(200===e)return void(i=200);(!zn.shouldRetryForStatus(e)||n.numEvents<=0)&&(l=!1),i=9e3+e%1e3}if(l){i=100;var p=n.retryCnt;n.isSync||(p<r?(s=!0,L((function(){n.isSync||v--,_(n.batches,p+1,n.isTeardown,n.isSync,5,n.isBeacon)}),!0,zn.getMillisToBackoffForRetry(p))):c=!0)}}finally{s||(f.setClockSkew(),F(n,i,o,c)),j(a,8004,n.isSync)}}(e,n,t,c)};try{a.sendPOST(n,o,t.isTeardown||t.isSync),e.sendListener&&e.sendListener(p,n,t.isSync||t.isTeardown,!1)}catch(e){E(o,0,{})}}),Ft(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(h)if(t.isSync||v++,m){var n={data:p.data,urlString:p.urlString,headers:p.headers},r=!1;Ft(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,h(e)}),t.isSync||t.isTeardown)}catch(e){r||h(p)}}))}else h(p)})),j(t.sizeExceed,8003,t.isSync)}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:o,sendReason:c}}),t.isSync)}}function F(t,n,r,o){try{o&&i._backOffTransmission(),200===n&&(o||t.isSync||i._clearBackOff(),function(e){if(b){var t=Ln();wn(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,b&&wn(n,(function(e){P(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),j(t.batches,n,t.isSync,!0)}finally{t.isSync||(v--,5!==r&&e.sendQueuedRequests(r,!t.isSync,t.isBeacon))}}function L(e,t,n){t?e():i._setTimeoutOverride(e,n)}function M(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){i.diagLog().throwInternal(kt.CRITICAL,dn.PostResponseHandler,"Response handler failed: "+e)}if(t){var o=JSON.parse(t);_n(o.webResult)&&_n(o.webResult.msfpc)&&Fn("MSFPC",o.webResult.msfpc,365)}}catch(e){}}function j(e,t,n,r){if(e&&e.length>0&&o){var a=o[(c=t,u=Jn[c],_n(u)||(u="oth",c>=9e3&&c<=9999?u="rspFail":c>=8e3&&c<=8999?u="drop":c>=1e3&&c<=1999&&(u="send")),u)];a&&Ft(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){L((function(){try{a.call(o,e,t,n)}catch(e){i.diagLog().throwInternal(kt.CRITICAL,dn.NotificationException,"send request notification failed: "+e)}}),r||n,0)}),(function(){return{batches:k(e),reason:t,isSync:n,sendSync:r}}),!n)}var c,u}e.initialize=function(e,t,n,r){if(c=e+c,b=!(s=t).config.disableEventTimings,i=n,y=new Vn(t),!(a=r)){p=!1,d=!Tn();var o=ft();o&&o.protocol&&"file:"===o.protocol.toLowerCase()&&(w=!1);var u=null;!function(){if(void 0!==typeof XMLHttpRequest){var e=it("XMLHttpRequest");if(e){var t=new e;return Boolean(hn(t.withCredentials)&&void 0!==typeof XDomainRequest)}}}()?Tn()?u=T:"undefined"!=typeof XMLHttpRequest&&(u=C):u=S,a={sendPOST:u}}},e._getDbgPlgTargets=function(){return[a,u,y]},e.addQueryStringParameter=function(e,t){for(var n=0;n<h.length;n++)if(h[n].name===e)return void(h[n].value=t);h.push({name:e,value:t})},e.addHeader=function(e,t){g[e]=t},e.canSendRequest=function(){return O()&&f.allowRequestSending()},e.sendQueuedRequests=function(e,t,n){var r=!_t.isNullOrUndefined(t)&&!t;x(m,r,0)&&_(I(),0,!1,r,e||0,!!n)},e.isCompletelyIdle=function(){return!l&&0===v&&0===m.length},e.addBatch=function(e){if(e&&e.count()>0){if(u.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&_(I(),0,!0,!0,2,!0)},e.pause=function(){l=!0},e.resume=function(){l=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&_([e],0,!1,!0,t||0,!!n)}}))},rr=kn?window:void 0,or=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="2.4.6";var o,i,a,s,c,u=!1,l=[],f=null,d=!1,v=0,p=1e4,h={},g="REAL_TIME",m=null,y=0,b=0,w={},S=-1;return Qe(t,r,(function(e,t){function r(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=cn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.sync)if(y||d)e.latency=ln,e.sync=!1;else if(i)return void i.sendSynchronousBatch(Un.create(e.iKey,[e]),3);var n=!1;v<p?n=!D(e,t):(n=!0,function(e,t){var n=cn;for(;n<=t;){var r=k(e,t,!0);if(r&&r.count()>0){var o=r.split(0,20);if(o.count()>0)return L("eventsDiscarded",[o],on),!0}n++}return!1}(e.iKey,e.latency)&&(n=!D(e,t))),n&&F("eventsDiscarded",[e],on)}function T(e,t,n,r){var o=A(e,t,n);return i.sendQueuedRequests(t,n,r),o}function C(){return v>0}function E(){S>=0&&A(S,c,!0)&&i.sendQueuedRequests(c,!0,!1);var e=h[g][1];!m&&!f&&e>=0&&!d&&(C()?m=O((function(){m=null,T(0===b?ln:cn,1,!0),b++,b%=2,E()}),e):b=0)}function O(t,n){0===n&&y&&(n=1);var r=1e3;return y&&(r=zn.getMillisToBackoffForRetry(y-1)),e._setTimeoutOverride(t,n*r)}function I(){null!==m&&(e._clearTimeoutOverride(m),m=null,b=0)}function x(t,n){I(),f&&(e._clearTimeoutOverride(f),f=null),d||T(cn,t,n,!0)}function k(e,t,n){var r=w[t];r||(r=w[t=cn]);var o=r.iKeyMap[e];return!o&&n&&(o=Un.create(e),r.batches.push(o),r.iKeyMap[e]=o),o}function _(t,n){i.canSendRequest()&&!y&&(a>0&&v>a&&(n=!0),n&&null==f&&e.flush(t,null,20))}function D(e,t){var n=k(e.iKey,e.latency,!0);return!!n.addEvents([e],t)&&(v++,t&&0===e.sendAttempt&&_(!e.sync,s>0&&n.count()>=s),!0)}function A(t,n,r){var o=!1;return!r||i.canSendRequest()?Ft(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=ln;n>=t;){var r=w[n];r&&r.batches&&(wn(r.batches,(function(t){i.addBatch(t)?o=o||t&&t.count()>0:e=e.concat(t.events()),v-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&F("eventsDiscarded",e,rn),o&&S>=t&&(S=-1,c=0)}),(function(){return{latency:t,sendReason:n}}),r):(S=S>=0?Math.min(S,t):t,c=Math.max(c,n)),o}function P(){(h={}).REAL_TIME=[2,1],h.NEAR_REAL_TIME=[6,3],h.BEST_EFFORT=[18,9]}function N(t,n){var r=e._notificationManager||{},o=r[t];if(o)try{o.apply(r,n)}catch(n){e.diagLog().throwInternal(kt.CRITICAL,dn.NotificationException,t+" notification failed: "+n)}}function F(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&N(e,[t].concat(n))}function L(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&wn(t,(function(t){t&&t.count()>0&&N(e,[t.events()].concat(n))}))}function M(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,p/6)}P(),w[ln]={batches:[],iKeyMap:{}},w[un]={batches:[],iKeyMap:{}},w[cn]={batches:[],iKeyMap:{}},M(),i=new nr(500,2,1,{requeue:function(t,n){var o=[];wn(t,(function(t){t&&t.count()>0&&wn(t.events(),(function(t){t&&(t.sync&&(t.latency=ln,t.sync=!1),t.sendAttempt<6?(jn(t,e.identifier),r(t,!1)):o.push(t))}))})),o.length>0&&F("eventsDiscarded",o,tn)},send:function(e,t,n){e&&e.length>0&&N("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){L("eventsSent",e,t),E()},drop:function(e,t){L("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:en)},rspFail:function(e){L("eventsDiscarded",e,tn),E()},oth:function(e,t){L("eventsDiscarded",e,en),E()}}),e._getDbgPlgTargets=function(){return[i]},e.initialize=function(r,s,c){Ft(s,(function(){return"PostChannel:initialize"}),(function(){var u=s;t.initialize(r,s,c),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=l.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(rr),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(rr);var f=u.getWParam;u.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},n.eventsLimitInMem>0&&(p=n.eventsLimitInMem),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),M(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(o=n.httpXHROverride),_n(r.anonCookieName)&&i.addQueryStringParameter("anoncknm",r.anonCookieName),i.sendHook=n.payloadPreprocessor,i.sendListener=n.payloadListener;var d,v,h=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;e._notificationManager=r.extensionConfig.NotificationManager,i.initialize(h,e.core,e,o),v=Bn("beforeunload",d=function(){x(2,!1)}),v=Bn("unload",d)||v,v=Bn("pagehide",d)||v,e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:c}}))},e.processTelemetry=function(t,o){jn(t,e.identifier);var i=(o=e._getTelCtx(o)).getExtCfg(e.identifier),a=!!n.disableTelemetry;i&&(a=a||!!i.disableTelemetry);var s=t;a||u||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(s.iKey=i.overrideInstrumentationKey),r(s,!0),E()),e.processNext(s,o)},e.setEventQueueLimits=function(e,t){p=e>0?e:1e4,a=t>0?t:0,M();var n=v>e;if(!n&&s>0)for(var r=cn;!n&&r<=ln;r++){var o=w[r];o&&o.batches&&wn(o.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}_(!0,n)},e.teardown=function(){x(2,!1),u=!0,i.teardown()},e.pause=function(){I(),d=!0,i.pause()},e.resume=function(){d=!1,i.resume(),E()},e.addResponseHandler=function(e){i._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){I(),P(),g="REAL_TIME",E(),function(e,t){if(e&&Ct(e))for(var n in e)Tt(e,n)&&t.call(e,n,e[n])}(e,(function(e,t){if(t.length>=2){if(t.splice(0,t.length-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var n=t[0]/t[1];t[0]=Math.ceil(n)*t[1]}h[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),d||(I(),n=n||1,e?(A(cn,n,e),null==f?f=O((function(){!function e(t,n){T(cn,n,!0),function e(t){i.isCompletelyIdle()?t():f=O((function(){e(t)}),.25)}((function(){t&&t(),l.length>0?f=O((function(){return e(l.shift(),n)}),0):(f=null,C()&&E())}))}(t,n)}),0):l.push(t)):(T(cn,n,!1),null!=t&&t()))},e.setMsaAuthTicket=function(e){i.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=C,e._setTransmitProfile=function(e){g!==e&&void 0!==h[e]&&(I(),g=e,E())},e._backOffTransmission=function(){y<4&&(y++,I(),E())},e._clearBackOff=function(){y&&(y=0,I(),E())}})),r}return __extends(t,e),t}(zt),ir=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),t.prototype.initialize=function(t,n){this._postChannel=new or;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.connectNotificationListener=function(e){e&&this.addNotificationListener(e)},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Rn);!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(Zn||(Zn={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}($n||($n={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Yn||(Yn={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(er||(er={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(tr||(tr={}));var sr=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._fullEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===tr.BasicEvent||e.eventFlags.diagnosticLevel===tr.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===tr.AlwaysOnNecessaryServiceDataEvent);return t||Object(Z.d)(Z.b.Info,Z.a.Sink,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}();function cr(e){return e?new Date(e):new Date}function ur(e,t,n){t&&t.forEach((function(t){if(!t.classification||t.classification===Y.a.SystemMetadata||t.classification===Y.a.EssentialServiceMetadata){var r,o;switch(r=n?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case X.Double:o=fn.Double;break;case X.Int64:o=fn.Int64;break;case X.Guid:o=fn.Guid;break;case X.String:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case X.Boolean:default:return void(e[r]=t.value)}var i={value:t.value,propertyType:o};e[r]=i}}))}var lr,fr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dr=function(){return(dr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},vr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return fr(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){e.data=dr(dr({},e.data),this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){ur(this._properties,e,!1)},t}(zt);(lr||(lr={})).newGuid=function(){return Object(x.v4)()};var pr,hr=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),gr=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new hr(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}(),mr=function(){function e(e,t){if(this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],this._partADataFieldsPlugin=new vr,t.trackOverride)this._trackOverride=t.trackOverride;else{if(!t||!t.endpointUrl)throw new Error("Missing Endpoint Url");var n=[this._partADataFieldsPlugin];t.plugins&&n.push.apply(n,t.plugins);var r={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:t.httpXHROverride,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0};t.stats&&t.stats.networkStats&&r.channelConfiguration&&(r.channelConfiguration.payloadListener=function(e,n){var r,o=n||e;o.data&&(null===(r=t.stats)||void 0===r||r.networkStats(o.data.length))}),this._applicationInsights=new ar,this._applicationInsights.initialize(r,n),this._applicationInsights.setUploadFrequency(t.uploadFrequency),this._applicationInsights.connectNotificationListener(t.notificationListener),t.stats&&this._applicationInsights.setPerfMgr(new gr(t.stats)),t.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights)}this._oneDSSinkSessionId=lr.newGuid(),this._epoch=(new Date).getTime().toString(),this._dataClassificationChecker=new sr,this.addPreprocessor(this._dataClassificationChecker),this.setPersistentDataFields(e)}return e.prototype.sendTelemetryEvent=function(e,t){var n=K(e);try{for(var r=0;r<this._preprocessors.length;r++)if(!this._preprocessors[r].processEvent(n))return;this.sendEventInternal(n,t)}catch(e){Object(Z.c)(Z.a.Sink,"1DS Sink",e)}},e.prototype.getPersistentDataFields=function(){return this._persistentDataFields},e.prototype.setPersistentDataFields=function(e){this._partADataFieldsPlugin.addDataFields(e),this._persistentDataFields=e},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._dataClassificationChecker.setFullEventsEnabled(e)},e.prototype.sendEventInternal=function(e,t){var n;if(this.eventsProcessed++,!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");var r,o,i,a,s=(r={telemetryEvent:e,oneDSSinkSessionId:this._oneDSSinkSessionId,eventSequence:this.eventsProcessed,timestamp:t},ur(a={},r.telemetryEvent.dataFields,!0),a["Event.Sequence"]={value:r.eventSequence,propertyType:fn.Int64},a["Event.Name"]=r.telemetryEvent.eventName,a["Event.Source"]="OTelJS",a["Event.Time"]={value:(i=cr(r.timestamp),i.getUTCFullYear()+"-"+Mn(i.getUTCMonth()+1)+"-"+Mn(i.getUTCDate())+"T"+Mn(i.getUTCHours())+":"+Mn(i.getUTCMinutes())+":"+Mn(i.getUTCSeconds())+"."+(o=i.getUTCMilliseconds(),(o<10?"00"+o:o<100?"0"+o:o.toString())+"Z")),propertyType:fn.DateTime},r.oneDSSinkSessionId&&(a["Event.Id"]=r.oneDSSinkSessionId+"."+r.eventSequence),r.telemetryEvent.eventContract&&(a["Event.Contract"]=r.telemetryEvent.eventContract.name,ur(a,r.telemetryEvent.eventContract.dataFields,!1)),a),c={iKey:e.telemetryProperties.ariaTenantToken,name:e.eventName,data:s,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:this.eventsProcessed,epoch:this._epoch}}};this._trackOverride?(null===(n=this._partADataFieldsPlugin)||void 0===n||n.processTelemetry(c),this._trackOverride(c)):this._applicationInsights&&this._applicationInsights.track(c)},e.prototype.hookUp1DSNotifications=function(e){var t=this;e.addNotificationListener({eventsSent:function(e){Object(Z.d)(Z.b.Info,Z.a.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),Object(Z.d)(Z.b.Verbose,Z.a.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),t.eventsSent+=e.length},eventsDiscarded:function(e,n){Object(Z.d)(Z.b.Error,Z.a.Transport,(function(){return"Discarded "+e.length+" event(s) because "+n})),Object(Z.d)(Z.b.Verbose,Z.a.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),t.eventsDiscarded+=e.length}})},e.prototype.flush=function(e){this._applicationInsights&&this._applicationInsights.flush(e)},e.prototype.shutdown=function(){if(this._applicationInsights)try{this._applicationInsights.shutdown()}catch(e){Object(Z.d)(Z.b.Error,Z.a.Transport,(function(){return"An error occurred on shutdown"}))}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(pr||(pr={}));var yr=function(){function e(e,t,n,r){var i=this;void 0===n&&(n=!1),void 0===r&&(r=new Ne),this.aggregateStream=n,this.telemetryLogger=r,this.name=function(){return"OTelSink"},this.writeEntry=function(e){(e?e.messageData:null)&&i.sendTraceMessage(e),(e?e.eventActionData:null)&&i.sendEventEntry(e)},this.flush=function(){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.apply(void 0,Object(o.g)(["color:black",e],t))}("OTelSink flush")},this.beginEvent=function(e,t){var n=i.getOTelActivityName(e||"EventError"),r=t&&t.context,o=r&&r.activityScope,a={activityScope:i.createOTelEvent(n,void 0,o),aggregatedScope:i.aggregateStream?i.createOTelEvent("Aggregated",n,o):void 0};return S(0===n.indexOf(i.eventNamePrefix),"eventName prefix not expected",n),{context:a}},this.endEvent=function(e,t){var n=t&&t.context;if(t){i.endEventScope(e,n.activityScope),n.aggregatedScope&&i.endEventScope(e,n.aggregatedScope);var r=e&&e.eventActionData;r&&b("OTelSink: 0x"+r.eventTagId.toString(16)+" "+r.eventActionType)}else S(n,"activityInfo not defined",t)},this.sendOTelEvent=function(e){S(e,"telemetryEvent not defined",e),e&&i.telemetryLogger.sendTelemetryEvent(e)},this.sendOTelActivity=function(e){S(e,"activityScope not defined",e),e&&e.endNow()},this.endEventScope=function(e,t){var n=e&&e.eventActionData;if(n){var r=e.eventFlags;U(Object(o.f)(e,["eventFlags"]),(function(e,n){t.addDataField(i.getDataField(e,n))})),t.setEventFlags(r);var a=n.responseCode,s=n.resultType;t.setSuccess("Failure"!==s&&"Timeout"!==s),void 0===a?t.setResult(0,"HRESULT"):t.setResult(a,"ResponseCode",n.eventTagId),i.sendOTelActivity(t)}else S(n,"eventActionData not defined",e)},this.getDataField=function(e,t){switch(typeof t){case"number":return{classification:Y.a.SystemMetadata,dataType:isFinite(t)&&Math.floor(t)===t?X.Int64:X.Double,name:e,value:t};case"boolean":return{classification:Y.a.SystemMetadata,dataType:X.Boolean,name:e,value:t};default:return{classification:Y.a.SystemMetadata,dataType:X.String,name:e,value:t.toString()}}},S(e.ariaTenantToken&&e.nexusTenantToken,"must supply tokens");var a,s,c,u,l,f,d,v=(u=(a=e).ariaTenantToken,l=a.feature,f=a.nexusTenantToken,(d=a.project)&&l&&u&&f&&{Office:(s={},s[d]=(c={},c[l]={},c.ariaTenantToken=u,c.nexusTenantToken=f,c),s)}||void 0);S(v,"unable to create subnamespaceTml"),this.eventNamePrefix=function(e){var t=e.eventNamePrefix,n=e.feature;return"Office."+e.project+"."+n+"."+(t||"")}(e),r.addSink(t),r.setTenantTokens(v)}return e.prototype.sendTraceMessage=function(e){var t=this,n=e?e.messageData:null;if(n){var r={correlationId:e.metadata.correlationId,eventTagId:n.eventTagId,logLevel:n.logLevel,message:n.message,messageDetails:n.messageDetails,sessionId:e.metadata.sessionId},o=[];R(r,(function(e,n){return o.push(t.getDataField(e,n))})),this.sendEvent("Message",e.eventFlags,o),b("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.message+","+r)}},e.prototype.sendEventEntry=function(e){var t=this,n=e?e.eventActionData:null;if(n){var r=[],i=e.eventFlags;U(Object(o.f)(e,["eventFlags"]),(function(e,n){r.push(t.getDataField(e,n))}));var a=function(e){var t=null;return e?(e.eventActionData?t=e.eventActionData.eventActionType:e.messageData&&(t="Message"),t):(S(e,"Invalid logEntry"),t)}(e)||"EventError";if(this.sendEvent(a,i,r),a&&"message"!==a.toLowerCase())r.push({classification:Y.a.SystemMetadata,dataType:X.String,name:"SourceEvent",value:a}),this.sendEvent("Aggregated",i,r);b("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.eventActionType+","+r)}},e.prototype.sendEvent=function(e,t,n){S(e,"eventName not defined",e,n),S(n&&n.length>0,"dataFieldInfo not valid",e,n);var r={dataFields:n,eventFlags:t,eventName:this.getOTelActivityName(e)};this.sendOTelEvent(r)},e.prototype.createOTelEvent=function(e,t,n){var r=ye.createNew(this.telemetryLogger,e);return t&&r.addDataField(this.getDataField("SourceEvent",t)),r},e.prototype.getOTelActivityName=function(e){return""+this.eventNamePrefix+e},e}();function br(e){void 0===e&&(e=!1);var t=e,n=function(e){return e&&-1!==e.indexOf("owsclg")};t||(t=!!n("undefined"!=typeof window&&window.location.search));t||(t=!!n("undefined"!=typeof document&&document.referrer));t&&(c=!0,q.removeSinks(C.name),q.addSink(new C))}function wr(e,t){var n=t.customMetadata,r=t.customSessionId,o=t.contentStorageUrl,i=t.enableFullEvents;q.clearSinks(),function(e,t,n){var r={BuildTimeStamp:"2022-05-13T00:11:46.088Z",CustomMetadata:e,CustomSessionId:t,Environment:O(z(n))};return I.setConfiguration(r),q.setConfiguration(r),r}(n,r,o).Environment===T.Prod&&function(e,t,n){void 0===n&&(n=!0);var r=new mr([ne("Session.Id",t),ne("App.Platform","Web"),ne("App.Name","OfficeWebSurfaces")],{endpointUrl:pr.PUBLIC});r.setFullEventsEnabled(n),q.addSink(new yr(e,r))}(e,r,i),br()}n(11);var Sr=[],Tr=Date.now(),Cr={},Er=!1,Or="",Ir=function(){return Tr},xr=function(){return Cr},kr=function(){return Er},_r=function(){return Or},Dr=function(e){return Sr.push(e)},Ar=function(){var e=xr();return e.fabricDependencies||(e.fabricDependencies=function(){if("React"in window&&"ReactDOM"in window&&"Fabric"in window){var e=window.React,t=e.createElement,n=e.useEffect,r=e.useMemo,o=e.useRef,i=e.useState,a=window.ReactDOM,s=a.render,c=a.unmountComponentAtNode,u=window.Fabric,l=u.Coachmark,f=u.Customizer,d=u.DefaultPalette,v=u.DirectionalHint,p=u.TeachingBubble,h=u.TeachingBubbleContent,g=u.ThemeGenerator,m=u.createTheme,y=u.isDark,b=u.getContrastRatio;return{Coachmark:l,Customizer:f,DefaultPalette:d,DirectionalHint:v,TeachingBubble:p,TeachingBubbleContent:h,ThemeGenerator:g,createElement:t,createTheme:m,getColorFromString:u.getColorFromString,getContrastRatio:b,isDark:y,registerIcons:u.registerIcons,render:s,styled:u.styled,themeRulesStandardCreator:u.themeRulesStandardCreator,unmountComponentAtNode:c,useEffect:n,useMemo:r,useRef:o,useState:i}}}()),e.fabricDependencies},Pr=function(){return Object(o.b)(void 0,void 0,void 0,(function(){var e,t,r,i,a;return Object(o.e)(this,(function(o){switch(o.label){case 0:e=xr(),o.label=1;case 1:return o.trys.push([1,4,,5]),Ar()?[3,3]:(n.p=null!==(a=null!==(i=e.fabricPackagePath)&&void 0!==i?i:void 0)&&void 0!==a?a:function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=/(.*\/)officewebsurfaces.core(\.min)?\.js/.exec(e[t].src);if(n)return n[1]}return""}(),n.p.endsWith("/")||(n.p+="/"),t=e,[4,n.e(1).then(n.bind(null,58))]);case 2:t.fabricDependencies=o.sent().fabricDependencies,o.label=3;case 3:return[3,5];case 4:throw r=o.sent(),q.error(593359773,"failed to load fabric dependencies",r),r;case 5:return[2,e.fabricDependencies]}}))}))},Nr=function(e){var t=e||{},n={ariaTenantToken:"cf7a002ba9374401bace61695550f784-d6d47427-ea71-43a3-ac3d-e25a6b4df199-6870",eventNamePrefix:"",feature:"Web",nexusTenantToken:1783,project:"ProgrammableSurfaces"};n&&n.ariaTenantToken&&n.nexusTenantToken||console.log("FG-OWS-OTEL config not valid",n),n&&wr(n,{customSessionId:t.logSessionId||k()}),function(e){try{var t=!1,n=e.logSettings;if(!t&&"string"==typeof n){var r=n;if("{"===r[0]){var o=JSON.parse(r);n=o.content||o}}!t&&n&&(t=!!n.consoleLog),t&&br(!0)}catch(t){console.log("FG-OWS-OTEL invalid log options",e,t)}}(t);var r=t.telemetryGroup||{},i={hostAppId:t.appId,hostBuild:t.build,hostEnv:t.env,hostLocale:t.originalLocale,surfaceId:t.surfaceId,hostAudience:r.audienceGroup,hostPlatform:r.platform};q.updateCustomData(i),q.event(593602525,"Init",{customData:Object(o.a)(Object(o.a)({buildTime:"2022-05-13T00:11:46.088Z",hostFlights:r.flights,loadDelay:L(),loadTime:t.surfaceInitTime?Date.now()-t.surfaceInitTime:void 0},j()),M())})},Fr=function(e,t,n,r,o,i,a){return void 0===a&&(a=-1),q.userActionEvent(e,t,{customData:{button:n,elapsedTime:Date.now()-o,itemCount:a,renderIndex:r,surfaceId:i}})},Lr=function(e,t,n){return void 0===t&&(t=!1),Object(o.b)(void 0,void 0,void 0,(function(){return Object(o.e)(this,(function(n){switch(n.label){case 0:return Cr=e||{},Er=t,Nr(e),e.preloadFabricPackage?[4,Pr()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},Mr=function(e){var t=e.attributes,n=void 0===t?{}:t,r=e.classNames,o=void 0===r?[]:r,i=e.id,a=void 0===i?"":i,s=e.parentElement,c=void 0===s?document.body||document:s,u=document.createElement("div");return Object.keys(n).forEach((function(e){return u.setAttribute(e,n[e])})),o.forEach((function(e){return u.classList.add(e)})),a&&(u.id=a),c.appendChild(u),u},jr=function(e,t){return document.getElementById(e)||Mr({id:e,parentElement:t})},Br=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];try{var o=document.querySelector(r);if(o)return{selector:r,targetElement:o}}catch(e){q.local("query selector error",e)}}},Rr=function(e){return Br(e)||{selector:null==e?void 0:e[0]}},Ur=function(e){e.parentElement?e.parentElement.removeChild(e):e.remove&&e.remove()},Hr=function(e,t,n){var r=function(){n(),e.removeEventListener(t,r)};return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},Vr=function(e,t){return Hr(e,"click",t)},Wr=0,qr=Date.now(),zr=function(){return"MS-OWS-id-"+qr+"-"+ ++Wr},Kr=function(e,t){window&&window.removeEventListener(e,t)};function Gr(e){return null!=e}var Jr,Xr=function(e){return Object(o.b)(void 0,void 0,Promise,(function(){return Object(o.e)(this,(function(t){return[2,new Promise((function(t,n){if(document.querySelector('script[src="'+e+'"]'))t(e);else{var r=document.createElement("script");r.src=e,r.onload=function(){return t(e)},r.onerror=function(e,t,o,i,a){r.remove();var s=a&&a.stack;q.error(594366469,"error loading script "+t+", "+o+", "+i+", "+s),n(null)},document.head.appendChild(r)}}))]}))}))},Qr=function(e){return"sequence"===e.surfaceType},Zr=function(){return _r()+"-App"},$r=function(){Fr(q.reserve(593504402),"SurfaceUnload","unload",0,Ir(),xr().surfaceId),Kr("beforeunload",$r)},Yr=function(e){void 0===e&&(e=!1),e&&Kr("beforeunload",$r),Sr.forEach((function(e){return e()})),Sr=[],function(){var e,t=document.getElementById(Zr());t&&(null===(e=Ar())||void 0===e||e.unmountComponentAtNode(t));var n=t&&t.parentElement;n&&n.getAttribute("data-ows")&&Ur(n)}()},eo=["anchorHint","closeButtonAction","closeButtonActionParams","closeButtonAriaLabel","backgroundColor","disableHostTheme","imageFetchCorsMode","position","preventAutoDismiss","smallHeadline"],to=function(e,t){return{alias:t,defaultValue:e}},no=to(0),ro=to(!1),oo=to({}),io=to(""),ao={backgroundColor:io,beaconColor:io,buttonHoverColor:io,primaryButtonHoverColor:io,primaryColor:io,secondaryColor:io,textColor:io,creativeId:io,payloadId:io,surfaceName:io,actionBeaconUrl:io,actionUrl:io,impressionBeaconUrl:io,isAA:ro,isControl:ro,telemetryEventName:io,delayLoad:no,eventDispatchDelay:no,fullRenderCheck:ro,preFetchDelay:no,renderCheckDelay:no,timeout:no,version:io,alternativeTriggerSelectors:to([]),anchorElementSelectors:to([]),anchorValidation:io,customTheme:to({}),disableHostTheme:ro,closeButtonAction:io,closeButtonActionParams:to({}),primaryButtonAction:io,primaryButtonActionParams:to({}),secondaryButtonAction:io,secondaryButtonActionParams:to({}),surfaceType:to("teaching"),targetAction:io,targetHidingClickSelectors:to([]),targetHidingElementSelectors:to([]),useNativeRender:ro,customProperties:to({}),alertAriaText:io,anchorHint:to("bottomCenter"),closeButtonAriaLabel:io,description:io,footer:io,hasCloseButton:ro,illustrationImage:io,imageAriaLabel:io,imageFetchCorsMode:to("no-cors"),position:to("top"),preventAutoDismiss:ro,primaryButton:io,primaryButtonAriaDescription:io,primaryButtonText:to("","primaryButton"),secondaryButton:io,secondaryButtonAriaDescription:io,secondaryButtonText:to("","secondaryButton"),smallHeadline:ro,title:io,itemCount:no,customStyles:oo,hasCoachMark:ro,localizedStyles:to({})},so=function(e,t){void 0===t&&(t=!0);var n=function(e,t){return function(n){var r=t[n.trim().toLowerCase()];if(r){var o=e[n],i="string"==typeof o&&o.trim();if(i?e[r]=i:r!==n&&(e[r]=o),i)try{var a=ao[r];switch(a&&typeof a.defaultValue){case"boolean":var s=i.toLowerCase();e[r]="t"===s[0]||"y"===s[0];break;case"number":e[r]=parseInt(i,10);break;default:"["!==i[0]&&"{"!==i[0]||(e[r]=JSON.parse(i))}}catch(e){q.error(593504394,"error parsing surface param",n,o,e)}}}}(e,(Jr||(Jr={},Object.keys(ao).forEach((function(e){Jr[e.toLowerCase()]=e}))),Jr));Object.keys(e).forEach(n),t&&!e.surfaceType&&(e.surfaceType=e.hasCoachMark?"coachmark":"teaching");var r=function(t){t&&(so(t,!1),Object.keys(t).forEach((function(n){e[n]=t[n]})))};r(e.customStyles),r(e.customProperties),Object.keys(ao).forEach((function(t){var n=t,r=ao[n],o=r&&r.alias;o&&void 0===e[n]&&void 0!==e[o]&&(e[n]=e[o])}))},co=function(e,t){for(var n=e.toString(),r={},o=0,i=Object.keys(t);o<i.length;o++){var a=i[o];if(a.endsWith(n)){var s=a.substring(0,a.length-1);r[s]=t[a]}}return so(r),r.surfaceType=r.surfaceType||"teaching",eo.forEach((function(e){void 0===r[e]&&void 0!==t[e]&&(r[e]=t[e])})),t.itemCount>1&&"teaching"===r.surfaceType&&void 0===r.footer&&(r.footer=e+" of "+t.itemCount),r},uo=function(e,t,n){try{if(e&&t){var r=xr(),o=!1;try{r&&r.beaconCallback&&r.beaconCallbackIsEnabled&&(r.beaconCallback({actionName:e,actionUrl:t}),o=!0)}catch(e){q.warn(592315552,"pageContext.beaconCallback call failed. Sending POST request to SetCampaignAction endpoint with actionName and actionUrl",e)}if(!o)!function(e,t,n){t?window&&window.fetch?window.fetch(t,n).then((function(e){e.ok||q.error(595656793,"fetching url was not successful with status "+e.status)})).catch((function(t){return q.error(595687457,"error fetching url "+e,t&&t.message)})):q.error(595687456,"fetch not available"):q.error(595687455,"invalid url")}("Beacon-"+e,n.actionUrl||"https://messaging.office.com/lifecycle/setcampaignaction",{body:JSON.stringify({actionName:encodeURIComponent(e),actionUrl:encodeURIComponent(t)}),headers:{"Content-Type":"application/json;charset=utf-8"},method:"POST"})}else q.warn(593504403,"actionName or actionUrl were undefined for beacon callback",e,t)}catch(e){q.error(593504404,"failed to perform beacon callback",e)}},lo=function(e,t){return uo(e,t.actionBeaconUrl,t)},fo=function(e,t){var n=function(e){switch(e){case"isAA":return"AASHOWED";case"isControl":return"CONTROLSHOWED";case"auto dismiss":case"close":return"dismiss";case"primary":return"click1";case"secondary":return"click2";case"error":default:return}}(e);if(n)return uo(n,t.actionBeaconUrl,t)},vo=!1,po=function(e){var t,n;vo||(n={disableWarnings:!0},void 0===(t=void 0)&&(t="https://static2.sharepointonline.com/files/fabric/assets/icons/"),(0,e.registerIcons)({fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+t+"fabric-icons-a13498cf.woff') format('woff')"},icons:{Cancel:""},style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"}},n),vo=!0)},ho=function(e,t){e.startsWith("data:image")||(window.fetch?window.fetch(e,{mode:t||"no-cors"}).catch((function(e){return q.error(593504400,"failed to pre fetch image",e&&e.message)})):(new Image).src=e)},go=function(e){!function(e){if(Qr(e))for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];r.startsWith("illustrationImage")&&ho(e[r],e.imageFetchCorsMode)}else e.illustrationImage&&ho(e.illustrationImage,e.imageFetchCorsMode)}(e);var t=Ar();t&&po(t)},mo=function(e){if(e&&(e.globalMethod||e.globalType)){var t=window,n=e.globalMethod?e.globalMethod.trim().split("."):[];if(n.length>0){"window"===n[0].toLowerCase()&&n.shift();var r=n.reduce((function(e,t){return e&&e[t]}),t);if(r&&r!==t){var o=e.delayLoad||10;return void _(o).then((function(){var t;r.apply(null,null!==(t=e.methodParams)&&void 0!==t?t:e)})).catch((function(e){q.error(561850442,"failed to execute global method "+n,e)}))}}var i=t[e.globalType||""];if(i){var a=new i(e),s=a[e.invocationMethod||""];if(s){o=e.delayLoad||10;_(o).then((function(){var t;s.call(a,null!==(t=e.methodParams)&&void 0!==t?t:e)})).catch((function(e){q.error(574142366,"failed to execute script method",e)}))}}}},yo=function(e,t){if(!e)return"none";if("function"==typeof e)return e(),"callback";var n,r=e.toLowerCase();if("script"!==r&&0!==r.indexOf("/")&&-1===r.indexOf(":")&&(r="https://"+r),0===r.indexOf("http"))return window.open(r)||q.error(574142367,"window.open reference is null for url button click action",r),"url";if(0===r.indexOf("event")){var i=null==t?void 0:t.eventName;if(i||(i=e.trim().split(":")[1]),!i)return q.error(574142368,"Invalid event name",e),"error";var a={detail:t};return document.dispatchEvent(new CustomEvent(i,a)),"event"}return t?0===r.indexOf("script")?(t.script?(n=t.script,Object(o.b)(void 0,void 0,Promise,(function(){return Object(o.e)(this,(function(e){return[2,Array.isArray(n)?Promise.all(n.map(Xr)):Xr(n)]}))}))).then((function(){mo(t)})).catch((function(e){q.error(574142369,"Script error "+t.script+" "+e)})):mo(t),"script"):"unhandled":"none"},bo=function(e,t,n,r,o,i,a){var s="error";try{s=yo(o,i)}catch(e){q.error(574142370,"error invoking input action")}q.userActionEvent(e,"SurfaceButtonClicked",{customData:{action:s,button:t,eventType:a||"",selector:n,surfaceType:r}})},wo=function(e,t){return e?e.startsWith(".")?function(e){var t=e.split(" ").filter((function(e){return e.startsWith(".")})).reduce((function(e,t){var n=e[0],r=e[1],o=Mr({classNames:t.split(".").filter((function(e){return e})),parentElement:r});return[n||o,o]}),[]),n=t[0],r=t[1],o=getComputedStyle(r).color;return Ur(n),o}(e)||t:e:t},So=n(21),To=window&&window.navigator&&(-1!==window.navigator.userAgent.indexOf("MSIE")||-1!==window.navigator.appVersion.indexOf("Trident/")),Co=To?"15px":"10px",Eo=function(e,t){var n,r,o,i;return{ariaDescribedBy:zr()+"-TD",ariaLabelledBy:zr()+"-TL",calloutProps:{directionalHint:t.anchorHint&&e.DirectionalHint[t.anchorHint],id:"obf-DynamicWebSurfaces",preventDismissOnLostFocus:null!==(n=t.preventAutoDismiss)&&void 0!==n?n:!t.focused,setInitialFocus:t.focused},closeButtonAriaLabel:null!==(r=t.closeButtonAriaLabel)&&void 0!==r?r:"Close",focusTrapZoneProps:{disableFirstFocus:!t.focused,forceFocusInsideTrap:!1},footerContent:t.footer,hasCloseIcon:null===(o=t.hasCloseButton)||void 0===o||o,hasSmallHeadline:null!==(i=t.smallHeadline)&&void 0!==i&&i,headline:t.title,illustrationImage:{"aria-label":t.imageAriaLabel,onLoadingStateChange:t.onImageLoaded,src:t.illustrationImage,styles:To?Io():void 0},isWide:Oo(t),onDismiss:t.onCalloutDismiss,primaryButtonProps:{ariaDescription:t.primaryButtonAriaDescription,ariaLabel:t.primaryButtonText,onClick:t.onPrimaryButtonClick,text:t.primaryButtonText},secondaryButtonProps:t.secondaryButtonText?{ariaDescription:t.secondaryButtonAriaDescription,ariaLabel:t.secondaryButtonText,onClick:t.onSecondaryButtonClick,text:t.secondaryButtonText}:void 0,styles:{content:{marginLeft:Oo(t)?Co:void 0}},target:t.targetElement}},Oo=function(e){return e&&"left"===e.position},Io=function(){return{image:{objectFit:"contain",height:"100%",width:"100%"}}},xo=function(e){return e.styled(function(e){return function(t){var n,r=e.createElement,i=e.Coachmark,a=e.DirectionalHint,s=e.TeachingBubbleContent,c=e.useEffect,u=(0,e.useRef)();c((function(){setTimeout((function(){var e,t;try{var n=null===(t=null===(e=u.current)||void 0===e?void 0:e._entityHost)||void 0===t?void 0:t.current;n&&!n.id&&(n.id="obf-DynamicWebSurfaces")}catch(e){q.error(594882953,"error setting coachmark id",e)}}),1e3)}),[]);var l=t.anchorHint||"bottomCenter";return r(i,{ariaAlertText:t.alertAriaText||t.title,ariaDescribedByText:t.description,ariaLabelledByText:t.title,color:t.theme&&t.theme.palette.themePrimary,componentRef:u,isCollapsed:!t.focused,isPositionForced:!1,onAnimationOpenEnd:t.onFocused,onDismiss:t.onCalloutDismiss,persistentBeak:!0,positioningContainerProps:{directionalHint:a[l]},preventDismissOnLostFocus:null!==(n=t.preventAutoDismiss)&&void 0!==n?n:!t.focused,preventFocusOnMount:!t.focused,target:t.targetElement},r(s,Object(o.a)({},Eo(e,t),{styles:t.styles}),t.description))}}(e),{},void 0,{scope:"TeachingBubble"})},ko=["description","primaryButtonText","selector","surfaceType","targetElement"],_o=function(e,t,n,r,o,i,a){return function(){bo(e,t,n.selector,n.surfaceType,o,i,a),r(!0),n.onClosed&&n.onClosed(t)}},Do=function(e,t){return function(n){var r,o;if(-1!==(null===(o=null===(r=null==n?void 0:n.currentTarget)||void 0===r?void 0:r.className)||void 0===o?void 0:o.indexOf("ms-TeachingBubble-closebutton")))_o(q.reserve(595858951),"close",e,t,e.closeButtonAction,e.closeButtonActionParams,n.type)();else{if(e.preventAutoDismiss)return void(n&&"click"===n.type&&q.userActionEvent(593504390,"SurfaceDismissPrevented",{customData:{autoDismiss:!0,eventType:"click",surfaceType:e.surfaceType}}));_o(q.reserve(595858950),"auto dismiss",e,t,e.closeButtonAction,e.closeButtonActionParams,n&&n.type)()}}},Ao=function(e,t){return function(){q.userActionEvent(593504391,"SurfaceFocused",{customData:{elapsedTime:Date.now()-e}}),null==t||t()}},Po=function(e){return function(t){return q.userActionEvent(593504392,"ImageLoaded",{customData:{elapsedTime:Date.now()-e,imageLoadedState:t}})}},No=function(e,t){return _o(q.reserve(595858952),"primary",e,t,e.primaryButtonAction,e.primaryButtonActionParams)},Fo=function(e,t){return _o(q.reserve(595858953),"secondary",e,t,e.secondaryButtonAction,e.secondaryButtonActionParams)},Lo=function(e){return function(t){var n=e.createElement,r=e.Customizer,i=e.useEffect,a=e.useMemo,s=e.useState,c=s(!1),u=c[0],l=c[1],f=s(!1),d=f[0],v=f[1],p=a((function(){return xo(e)}),[]),h=a((function(){return function(e){return function(t){var n=e.createElement,r=e.TeachingBubble,i=e.useEffect,a=(0,e.useRef)();return i((function(){var e=function(e){var n,r,o;Object(So.a)(null!==(o=null===(r=null===(n=a.current)||void 0===n?void 0:n.rootElement)||void 0===r?void 0:r.current)&&void 0!==o?o:null,e.target)&&t.onFocused()};return document.addEventListener("click",e),document.addEventListener("focus",e),function(){document.removeEventListener("click",e),document.removeEventListener("focus",e)}}),[]),n("div",null,n("div",{role:"alert",style:{height:0,opacity:0,pointerEvents:"none",position:"fixed",width:0}},t.alertAriaText||t.title),n(r,Object(o.a)({},Eo(e,t),{componentRef:a}),t.description))}}(e)}),[]);if(i((function(){var e=function(e){e&&9!==e.keyCode&&"Tab"!==e.key&&117!==e.keyCode&&"F6"!==e.key||v(!0)};return document.addEventListener("keyup",e),function(){return document.removeEventListener("keyup",e)}}),[]),u||!function(e){var t=ko.filter((function(t){return!Gr(e[t])}));return!t.length||(q.error.apply(q,Object(o.g)([593504388,"Invalid props passed to OfficeWebServiceContainer"],t)),!1)}(t))return null;var g=Date.now(),m=Object(o.a)(Object(o.a)({},t),{focused:d,onCalloutDismiss:Do(t,l),onFocused:Ao(g,(function(){var e;v(!0),null===(e=t.onUpdated)||void 0===e||e.call(t)})),onImageLoaded:Po(g),onPrimaryButtonClick:No(t,l),onSecondaryButtonClick:Fo(t,l)}),y=function(){switch(t.surfaceType){case"coachmark":return n(p,Object(o.a)({},m));case"teaching":return n(h,Object(o.a)({},m));default:return q.error(593504393,"attempted to render unknown surface",t.surfaceType),null}}();if(!y)return null;var b=function(e,t,n){var r,i=t||{},a=i.scopedSettings,s=void 0===a?{}:a,c=i.settings,u=void 0===c?{}:c,l=function(e,t,n){var r=e.getColorFromString,o=e.getContrastRatio,i=e.DefaultPalette,a=e.ThemeGenerator,s=(0,e.themeRulesStandardCreator)();a.setSlot(s.primaryColor,t,!1,!0),a.setSlot(s.themeTertiary,n,!1,!0);var c=o(r(i.white),s.themePrimary.color)>o(r(i.black),s.themePrimary.color);return a.setSlot(s.white,c?i.white:i.black,!1,!0),a.getThemeAsJson(s)}(e,n.primaryColor||!n.disableHostTheme&&n.primaryColour||n.backgroundColor||e.DefaultPalette.neutralLighter,n.secondaryColor||!n.disableHostTheme&&n.secondaryColour||e.DefaultPalette.neutralSecondary),f=null!==(r=u.theme)&&void 0!==r?r:e.createTheme({palette:l}),d=f.palette;return Object(o.a)(Object(o.a)({},t),{scopedSettings:s,settings:Object(o.a)(Object(o.a)({},u),{theme:Object(o.a)(Object(o.a)({},f),{palette:Object(o.a)(Object(o.a)({},d),{themeDark:wo(n.buttonHoverColor,d.themeDark),themeDarkAlt:wo(n.buttonHoverColor,d.themeDarkAlt),themeLighter:wo(n.primaryButtonHoverColor,d.themeLighter),themePrimary:wo(n.backgroundColor,d.themePrimary),themeTertiary:wo(n.beaconColor,d.themeTertiary),white:wo(n.textColor,d.white)})})})})}(e,t.customTheme,t);return b?n(r,Object(o.a)({},b),y):y}},Mo=function(e){var t=e.isAlternateTrigger,n=void 0!==t&&t,r=e.surfaceParams,o=e.targetElementInfo,i=o.selector,a=o.targetElement,s=e.onClick,c=Date.now();return Vr(a,(function(){q.userActionEvent(590432290,"TargetElementClicked",{customData:{isAlternateTrigger:n,selector:i,timeToClick:Date.now()-c}}),lo("conversion",r);var e=r&&r.targetAction;e&&"function"==typeof e&&e(),s()}))},jo=function(e,t,n,r,i){var a=t.selector,s=t.targetElement;return Object(o.b)(void 0,void 0,void 0,(function(){var t,c,u,l,f,d,v,p,h;return Object(o.e)(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),(t=document.getElementById(_r()))||(t=Mr({attributes:(h={},h["data-ows"]="true",h.style="all: initial",h),id:_r()})),c=jr(Zr(),t),[4,Pr()];case 1:return u=g.sent(),l=u.createElement,f=u.render,d=u.setDefaultTarget,po(u),d&&(v=jr(_r()+"-Layer",t),d("#"+v.id)),f(l(Lo(u),Object(o.a)(Object(o.a)(Object(o.a)({},xr()),e),{onClosed:i,onUpdated:r,selector:a,targetElement:s})),c,n),[3,3];case 2:if(p=g.sent(),q.error(593504384,"error thrown in renderInternal",a,p),i&&i("error"),kr())throw p;return[3,3];case 3:return[2]}}))}))},Bo=function(e,t,n){var r=Br(e.anchorElementSelectors);if(r){var o=r.selector,i=r.targetElement,a=i&&i.getBoundingClientRect()||{},s=a.bottom,c=a.left,u=a.right,l=a.top;q.event(593504385,"SurfaceSelectorMatched",{customData:{anchorHint:e.anchorHint,selector:o,bottom:s,left:c,right:u,top:l}})}else q.error(593504386,"Couldn't find element",e.anchorElementSelectors);return e.isAA?(e.anchorElementSelectors&&!r||t&&t("SurfaceAATriggered"),void(n&&n("isAA"))):e.isControl?(e.anchorElementSelectors&&!r||t&&t("SurfaceControlTriggered"),void(n&&n("isControl"))):r||void(n&&n("error"))},Ro=function(e,t){return null==e?void 0:e.map((function(e){return Br([e])})).filter(Gr).forEach((function(e){return Dr(t(e))}))},Uo=function(e,t,n,r,i,a){return void 0===t&&(t=!0),function(){return Object(o.b)(void 0,void 0,void 0,(function(){var s,c,u;return Object(o.e)(this,(function(o){switch(o.label){case 0:return(s=Bo(e,r,a))?(null===(u=e.targetHidingElementSelectors)||void 0===u?void 0:u.map((function(e){return Br([e])})).filter(Gr).some((function(e){return t=s.targetElement,n=e.targetElement,r=t.getBoundingClientRect(),!((o=n.getBoundingClientRect()).right<r.left||o.left>r.right||o.top>r.bottom||o.bottom<r.top);var t,n,r,o})))?(q.warn(590432320,"Target covered",{selector:s.selector}),lo("dismiss",e),[2]):(Dr(Mo({onClick:c=function(){t&&Yr()},surfaceParams:e,targetElementInfo:s})),Ro(e.alternativeTriggerSelectors,(function(t){return Mo({isAlternateTrigger:!0,onClick:c,surfaceParams:e,targetElementInfo:t})})),Ro(e.targetHidingClickSelectors,(function(t){return function(e){var t=e.surfaceParams,n=e.targetElementInfo,r=n.selector,o=n.targetElement,i=e.onClick,a=Date.now();return Vr(o,(function(){q.userActionEvent(590432291,"HidingElementClicked",{customData:{selector:r,timeToClick:Date.now()-a}}),lo("dismiss",t),i()}))}({onClick:c,surfaceParams:e,targetElementInfo:t})})),Dr(function(e,t,n){if(void 0===n&&(n=!0),n){var r=new IntersectionObserver((function(e){e.some((function(e){return!e.isIntersecting}))&&(t(),r.disconnect())}));return r.observe(e),function(){return r.disconnect()}}var o=new MutationObserver((function(n){n.forEach((function(n){("childList"===n.type&&Array.prototype.slice.call(n.removedNodes).filter((function(t){return t===e})).length||"attributes"===n.type&&n.target===e&&("none"===e.style.display||"hidden"===e.style.visibility))&&(t(),o.disconnect())}))}));return e.parentElement?o.observe(e.parentElement,{attributeFilter:["style"],childList:!0,subtree:!0}):o.observe(e,{attributeFilter:["style"]}),function(){return o.disconnect()}}(s.targetElement,(function(){q.warn(590432321,"Target removed",{selector:s.selector}),lo("dismiss",e),Yr()}))),Dr(Hr(window,"resize",(function(){q.warn(590432322,"Page resized",{selector:s.selector}),lo("dismiss",e),Yr()}))),e.useNativeRender||!n?[3,2]:[4,qo(a,i,n,r,e,s,Ir(),xr().surfaceId)]):[2];case 1:return o.sent(),[3,4];case 2:return[4,jo(e,s,r,i,a)];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))}},Ho=function(e,t,n,r,i,a,s){return void 0===n&&(n=!0),Object(o.b)(void 0,void 0,void 0,(function(){var c;return Object(o.e)(this,(function(o){switch(o.label){case 0:return Or=t,c=Uo(e,n,r,i,a,s),void 0!==e.delayLoad&&e.delayLoad>0?(_(e.delayLoad).then(c).catch((function(e){q.error(593504387,"failed to render delay loaded surface",e),s&&s("error")})),[3,3]):[3,1];case 1:return[4,c()];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},Vo=function(e,t,n,r,i,a,s,c){return Object(o.b)(void 0,void 0,void 0,(function(){return Object(o.e)(this,(function(u){switch(u.label){case 0:return n>e.itemCount?(q.assert(n<=e.itemCount,"inconsistent state"),[2]):[4,Ho(co(n,e),r,!1,t,i,s,(function(i){return Object(o.b)(void 0,void 0,void 0,(function(){return Object(o.e)(this,(function(o){switch(o.label){case 0:return Yr(!0),"error"===i&&n<=1?(c&&c(i),[2]):(Fr(q.reserve(593504395),"SurfaceDismissed",i,n,Ir(),xr().surfaceId,e.itemCount),fo(i,e),n<e.itemCount&&("primary"===i||"error"===i)?[4,Vo(e,t,n+1,r,void 0,a,s,c)]:[3,2]);case 1:return o.sent(),a&&a(i,n),[3,3];case 2:c&&c(i),o.label=3;case 3:return[2]}}))}))}))];case 1:return u.sent(),[2]}}))}))},Wo=function(e,t,n,r,i,a,s,c){return Object(o.b)(void 0,void 0,void 0,(function(){var u,l,f;return Object(o.e)(this,(function(d){switch(d.label){case 0:l=function(e,t,n,r,i,a){for(var s=function(t,r,o){void 0===r&&(r=!1);var i=r?void 0:t+1,a=n();try{a&&t>=0&&t<a.length&&a.slice(t,i).reverse().forEach((function(e){e&&e()})),r&&o&&bo(q.reserve(561850440),"close",void 0,o.surfaceType,o.closeButtonAction,o.closeButtonActionParams)}catch(n){q.error(593602519,"failed to dismiss surface "+(t+1)+" of "+e.itemCount+(r?"plus all remaining surfaces":void 0),n)}},c=function(e){return function(t){return u(t,e)}},u=function(n,r){"error"===n&&r<1?t&&t(n):(Fr(q.reserve(593602520),"SurfaceDismissed",n,r+1,i,a,e.itemCount),fo(n,e),r<e.itemCount-1&&("primary"===n||"error"===n)?s(r,!1,l[r]):(t&&t(n),s(r,!0,l[r])))},l=[],f=function(t){var n=co(t,e),i=Rr(n.anchorElementSelectors),a=t-1;l.push(Object(o.a)(Object(o.a)(Object(o.a)({},n),i),{onClosed:function(){return u("close",a)},onUnsupportedSurfaceType:r(n,c(a)),primaryButtonAction:n.primaryButtonText&&function(){return u("primary",a)},secondaryButtonAction:n.secondaryButtonText&&function(){return u("secondary",a)}}))},d=1;d<=e.itemCount;d++)f(d);return l}(c,t,(function(){return u}),(function(e,t){return function(){return Object(o.b)(void 0,void 0,void 0,(function(){var r;return Object(o.e)(this,(function(o){switch(o.label){case 0:return(r=Bo(e,s,t))?[4,jo(e,r,s,n,t)]:[2];case 1:return o.sent(),[2]}}))}))}}),e,a),d.label=1;case 1:return d.trys.push([1,3,,5]),[4,r(l)];case 2:return u=d.sent(),q.info(593602521,"host render succeeded (multi-surface)"),null==s||s(),[3,5];case 3:return f=d.sent(),q.error(593602522,"error with host rendering (multi-surface), falling back to internal renderer",f),[4,Vo(c,r,1,i,s,n,n,t)];case 4:return d.sent(),[3,5];case 5:return[2]}}))}))},qo=function(e,t,n,r,i,a,s,c){return Object(o.b)(void 0,void 0,void 0,(function(){var u,l,f;return Object(o.e)(this,(function(d){switch(d.label){case 0:l=function(t){var n;null==e||e(t),null===(n=null==u?void 0:u[0])||void 0===n||n.call(u)},d.label=1;case 1:return d.trys.push([1,3,,5]),[4,n([Object(o.a)(Object(o.a)(Object(o.a)({},i),a),{onClosed:function(){l("close")},onFullRenderCompleted:function(e){e||Fr(q.reserve(526401607),"SurfaceFullRenderCompleted","full render complete",0,s,c)},onUnsupportedSurfaceType:function(){return jo(i,a,r,t,l)},primaryButtonAction:i.primaryButtonText&&function(){bo(q.reserve(574144658),"primary",null==a?void 0:a.selector,i.surfaceType,i.primaryButtonAction,i.primaryButtonActionParams),l("primary")},secondaryButtonAction:i.secondaryButtonText&&function(){bo(q.reserve(574144659),"secondary",null==a?void 0:a.selector,i.surfaceType,i.secondaryButtonAction,i.secondaryButtonActionParams),l("secondary")}})])];case 2:return u=d.sent(),q.info(593602523,"host render succeeded"),null==r||r(),[3,5];case 3:return f=d.sent(),q.error(593602524,"error with host rendering, falling back to internal renderer",f),[4,jo(i,a,r,t,e)];case 4:return d.sent(),[3,5];case 5:return[2]}}))}))},zo=function(e,t,n,r){return function(i,a,s){var c;void 0===i&&(i="SurfaceLaunched"),void 0===a&&(a=!0),c=Date.now(),Tr=c,q.event(593504396,i,{customData:Object(o.a)(Object(o.a)(Object(o.a)({creativeId:r.creativeId,payloadId:r.payloadId,surfaceId:n,surfaceName:r.surfaceName,elapsedTime:Ir()-t,error:s||"",result:a,surfaceType:r.surfaceType},j()),M()),{isAA:r.isAA,isControl:r.isControl,telemetryEventName:r.telemetryEventName})}),Ko("Opened",e,n,r),s||function(e){uo("impression",e.impressionBeaconUrl,e)}(r)}},Ko=function(e,t,n,r,o){void 0===o&&(o=!0);var i={detail:{action:e,creativeId:r.creativeId,id:n,isAA:r.isAA,isControl:r.isControl,isHidden:r.isAA||r.isControl,payloadId:r.payloadId,success:o,surfaceType:r.surfaceType,telemetryEventName:r.telemetryEventName,renderTargetId:t}},a=r.eventDispatchDelay||10;_(a).then((function(){return document.dispatchEvent(new CustomEvent("FGWebSurfaceEvent",i))})).catch((function(e){q.error(593602575,"failed to dispatch event",e)}))},Go=function(e,t,n,r){return Object(o.b)(void 0,void 0,void 0,(function(){var i,a,s,c,u,l,f,d;return Object(o.e)(this,(function(o){switch(o.label){case 0:if(q.updateCustomData({impressionId:null!=r?r:k()}),i=t||"obf-WebSurfacesContainer",!e)return q.error(593504397,"surface params are not provided"),[2];so(e),a=zo(i,Date.now(),n,e),o.label=1;case 1:return o.trys.push([1,9,,10]),e.isControl||e.isAA||(v="beforeunload",p=$r,window&&window.addEventListener(v,p),s=e.preFetchDelay||10,_(s).then((function(){go(e)})).catch((function(e){return q.error(593504398,"failed to pre-load resources",e)}))),c=function(t){Fr(q.reserve(593504399),"SurfaceCompleted",t,0,Ir(),n),Kr("beforeunload",$r),fo(t,e),Ko("Dismissed",i,n,e),!e.useNativeRender&&l&&bo(q.reserve(561850441),"close",void 0,e.surfaceType,e.closeButtonAction,e.closeButtonActionParams)},u=function(){return Ko("Updated",i,n,e)},l=xr().renderCallback,Qr(e)?e.useNativeRender||!l?[3,3]:[4,Wo(Ir(),c,u,l,i,n,a,e)]:[3,6];case 2:return o.sent(),[3,5];case 3:return[4,Vo(e,l,1,i,a,u,u,c)];case 4:o.sent(),o.label=5;case 5:return[3,8];case 6:return[4,Ho(e,i,!0,l,a,u,c)];case 7:o.sent(),o.label=8;case 8:return function(e){if(!e.isAA&&!e.isControl){var t=document.documentElement||document.body,n=["div[class^='entityHost']","div[class^='pulsingBeacon']","div[class~='ms-PositioningContainer-layerHost]","div[class^='calloutMain']","div[aria-roledescription='Teaching notification']","div[class~='ms-TeachingBubble-content']"],r=!1,o=e.fullRenderCheck||!1,i=e.renderCheckDelay||(o?5e3:2e3),a=new MutationObserver((function(e){for(var t=function(e){if(n.some((function(t){return 1===e.target.querySelectorAll(t).length})))return r=!0,a.disconnect(),{value:void 0}},o=0,i=e;o<i.length;o++){var s=t(i[o]);if("object"==typeof s)return s.value}}));o&&a.observe(t,{attributes:!0,childList:!0,subtree:!0}),_(i).then((function(){o||(r=n.some((function(e){return 1===document.querySelectorAll(e).length}))),r||(o&&a.disconnect(),q.error(527974729,"failed to render surface "+e.surfaceType,e.creativeId))})).catch((function(e){return q.error(527974730,"failed to log surface rendering",e)}))}}(e),function(e){if(e&&!e.isAA&&!e.isControl)try{var t=Rr(e.anchorElementSelectors),n=t.selector,r=t.targetElement;if(!r)return;var o=r.getBoundingClientRect();if(o.height<1||o.width<1)q.error(526401692,"target element "+n+" of surface "+e.surfaceType+" is hidden",e.creativeId)}catch(t){q.error(526401693,"failed to verify target element of surface "+e.surfaceType+", "+e.creativeId,t)}}(e),[3,10];case 9:if(f=o.sent(),d="SurfaceLaunched",e.isControl?d="SurfaceControlTriggered":e.isAA&&(d="SurfaceAATriggered"),a(d,!1,f&&f.message),kr())throw f;return[3,10];case 10:return[2]}var v,p}))}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"SdxWacSink",(function(){return a})),n.d(t,"isWacAgave",(function(){return i}));var r=n(4),o=n(1);function i(){return"undefined"!=typeof Office&&void 0!==Office.context&&void 0!==Office.context.platform?Office.context.platform===Office.PlatformType.OfficeOnline:"undefined"!=typeof OfficeExt&&void 0!==OfficeExt.HostName&&void 0!==OfficeExt.HostName.Host&&"function"==typeof OfficeExt.HostName.Host.getInstance&&"function"==typeof OfficeExt.HostName.Host.getInstance().getPlatform&&OfficeExt.HostName.Host.getInstance().getPlatform()===Office.PlatformType.OfficeOnline}var a=function(){function e(){}return e.isSupported=function(){return i()&&"object"==typeof OSF&&"function"==typeof OSF.getClientEndPoint&&"object"==typeof OSF._OfficeAppFactory&&"function"==typeof OSF._OfficeAppFactory.getId&&"object"==typeof OSF.AgaveHostAction&&"number"==typeof OSF.AgaveHostAction.SendTelemetryEvent},e.prototype.sendTelemetryEvent=function(e,t){try{if(e.dataFields&&e.dataFields.filter((function(e){return e.classification&&e.classification!==r.a.SystemMetadata})).length>0)return;var n=OSF._OfficeAppFactory.getId(),i=OSF.AgaveHostAction.SendTelemetryEvent;OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[n,i,e])}catch(e){Object(o.c)(o.a.Sink,"AgaveWacSink",e)}},e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){void 0===n&&(n=!0);var o=!1;if(e&&t)if(n)if(e===t)o=!0;else for(o=!1;t;){var i=Object(r.a)(t);if(i===e){o=!0;break}t=i}else e.contains&&(o=e.contains(t));return o}}]);
//# sourceMappingURL=officewebsurfaces.core.min.js.map